# Fancy Installer Creation Guide - DJ Booking System

## ?? Creating a Professional Installer with Graphics

### **Best Installer Builders for .NET**

#### **1. Inno Setup (FREE - Recommended)**
? **Best for custom graphics and branding**
- Free and open source
- Supports custom graphics, colors, and themes
- Scripting language for advanced customization
- Wizard-style interface
- Custom images at every step

**Download**: https://jrsoftware.org/isinfo.php

---

#### **2. Advanced Installer (PAID but Professional)**
? **Most professional-looking results**
- Visual designer (drag-and-drop)
- Built-in themes and templates
- Custom branding wizard
- Animated graphics support
- Free trial available

**Download**: https://www.advancedinstaller.com/

---

#### **3. WiX Toolset (FREE - Advanced)**
? **Maximum control, XML-based**
- Free and open source
- Used by Microsoft
- Complete customization
- Steeper learning curve
- Custom UI with graphics

**Download**: https://wixtoolset.org/

---

## ?? Inno Setup - Detailed Implementation

### **Step 1: Install Inno Setup**

1. Download from: https://jrsoftware.org/isdl.php
2. Install Inno Setup Compiler
3. Install **ISTool** (optional GUI): http://www.istool.org/

---

### **Step 2: Prepare Your Graphics**

Create these image files for your installer:

#### **Required Images:**

| Image | Size | Purpose |
|-------|------|---------|
| **WizardImage.bmp** | 164 x 314 pixels | Left side of installer |
| **WizardSmallImage.bmp** | 55 x 55 pixels | Top right corner |
| **Icon.ico** | 256x256 | Application icon |
| **SetupIcon.ico** | 256x256 | Installer icon |

#### **Recommended Theme:**
- **Background**: Dark space theme (matching your app)
- **Accent**: Neon green (`#00FF00`)
- **Logo**: The Fallen Collective branding
- **Effects**: Glow, stars, futuristic

---

### **Step 3: Create Installer Script**

Create `installer.iss`:

```iss
; DJ Booking System - Fancy Installer Script
; The Fallen Collective

#define MyAppName "DJ Booking System"
#define MyAppVersion "1.2.0"
#define MyAppPublisher "The Fallen Collective"
#define MyAppURL "https://fallencollective.com"
#define MyAppExeName "DJBookingSystem.exe"

[Setup]
; Basic Info
AppId={{YOUR-UNIQUE-GUID-HERE}}
AppName={#MyAppName}
AppVersion={#MyAppVersion}
AppPublisher={#MyAppPublisher}
AppPublisherURL={#MyAppURL}
AppSupportURL={#MyAppURL}
AppUpdatesURL={#MyAppURL}
DefaultDirName={autopf}\{#MyAppName}
DefaultGroupName={#MyAppName}
AllowNoIcons=yes
LicenseFile=LICENSE.txt
InfoBeforeFile=README.txt
OutputDir=Installer\Output
OutputBaseFilename=DJBookingSystem-Setup-v{#MyAppVersion}
SetupIconFile=Assets\SetupIcon.ico
UninstallDisplayIcon={app}\{#MyAppExeName}
Compression=lzma2/ultra64
SolidCompression=yes
WizardStyle=modern

; Graphics and Colors
WizardImageFile=Assets\WizardImage.bmp
WizardSmallImageFile=Assets\WizardSmallImage.bmp
WizardImageStretch=yes
WizardImageBackColor=$000A0A
; Dark background color (#0A0A0A)

; Custom Colors
WizardBorderColor=$00FF00
; Neon green border (#00FF00)

; Modern UI
DisableWelcomePage=no
DisableProgramGroupPage=yes
PrivilegesRequired=admin

[Languages]
Name: "english"; MessagesFile: "compiler:Default.isl"

[Tasks]
Name: "desktopicon"; Description: "{cm:CreateDesktopIcon}"; GroupDescription: "{cm:AdditionalIcons}"; Flags: unchecked
Name: "quicklaunchicon"; Description: "{cm:CreateQuickLaunchIcon}"; GroupDescription: "{cm:AdditionalIcons}"; Flags: unchecked; OnlyBelowVersion: 6.1; Check: not IsAdminInstallMode

[Files]
; Main Application
Source: "bin\Release\net8.0-windows\publish\{#MyAppExeName}"; DestDir: "{app}"; Flags: ignoreversion
Source: "bin\Release\net8.0-windows\publish\*"; DestDir: "{app}"; Flags: ignoreversion recursesubdirs createallsubdirs

; WebView2 Runtime (optional - include if needed)
Source: "Prerequisites\MicrosoftEdgeWebview2Setup.exe"; DestDir: "{tmp}"; Flags: deleteafterinstall

[Icons]
Name: "{group}\{#MyAppName}"; Filename: "{app}\{#MyAppExeName}"; IconFilename: "{app}\{#MyAppExeName}"
Name: "{group}\{cm:UninstallProgram,{#MyAppName}}"; Filename: "{uninstallexe}"
Name: "{autodesktop}\{#MyAppName}"; Filename: "{app}\{#MyAppExeName}"; Tasks: desktopicon; IconFilename: "{app}\{#MyAppExeName}"
Name: "{userappdata}\Microsoft\Internet Explorer\Quick Launch\{#MyAppName}"; Filename: "{app}\{#MyAppExeName}"; Tasks: quicklaunchicon

[Run]
; Install WebView2 if not present
Filename: "{tmp}\MicrosoftEdgeWebview2Setup.exe"; Parameters: "/silent /install"; StatusMsg: "Installing WebView2 Runtime..."; Flags: waituntilterminated

; Launch app after install
Filename: "{app}\{#MyAppExeName}"; Description: "{cm:LaunchProgram,{#StringChange(MyAppName, '&', '&&')}}"; Flags: nowait postinstall skipifsilent

[Code]
// Custom code for fancy effects

procedure InitializeWizard();
var
  WelcomeLabel: TNewStaticText;
begin
  // Custom welcome message with style
  WelcomeLabel := TNewStaticText.Create(WizardForm);
  WelcomeLabel.Parent := WizardForm.WelcomePage;
  WelcomeLabel.Caption := 'Welcome to The Fallen Collective DJ Booking System';
  WelcomeLabel.Font.Size := 12;
  WelcomeLabel.Font.Style := [fsBold];
  WelcomeLabel.Font.Color := $00FF00; // Neon green
  WelcomeLabel.Top := 180;
  WelcomeLabel.Left := 170;
  WelcomeLabel.Width := 300;
  WelcomeLabel.Height := 50;
  WelcomeLabel.WordWrap := True;
end;

// Check if WebView2 is already installed
function IsWebView2Installed: Boolean;
var
  RegKey: string;
begin
  RegKey := 'SOFTWARE\WOW6432Node\Microsoft\EdgeUpdate\Clients\{F3017226-FE2A-4295-8BDF-00C3A9A7E4C5}';
  Result := RegKeyExists(HKLM, RegKey);
end;

function PrepareToInstall(var NeedsRestart: Boolean): String;
begin
  // Custom pre-install checks
  Result := '';
  
  if not IsWebView2Installed then
  begin
    MsgBox('WebView2 Runtime will be installed automatically.', mbInformation, MB_OK);
  end;
end;
```

---

### **Step 4: Create Custom Graphics**

#### **Using Photoshop/GIMP:**

**WizardImage.bmp (164x314 pixels):**
```
???????????????????
?                 ?
?   [DJ LOGO]     ?  <- Your DJ/music themed logo
?                 ?
?                 ?
?  ? Stars ?    ?  <- Space/stars background
?                 ?
?   FALLEN        ?
?  COLLECTIVE     ?  <- Neon green text
?                 ?
?  ?? ?? ??      ?  <- Music icons
?                 ?
???????????????????
```

**WizardSmallImage.bmp (55x55 pixels):**
```
?????????
?  [D]  ?  <- DJ icon or logo
?????????
```

#### **Quick Templates:**

**Option 1: Free Design Tools**
- **Canva** (https://canva.com) - Free templates
- **Photopea** (https://photopea.com) - Free Photoshop alternative
- **GIMP** (https://gimp.org) - Free image editor

**Option 2: Pre-made Templates**
- Search "installer wizard images" on GraphicRiver
- Search "setup wizard background" on Creative Market
- Free resources: Unsplash, Pexels (space/music themes)

---

### **Step 5: Build Installer**

```bash
# Open Inno Setup Compiler
# File ? Open ? installer.iss
# Build ? Compile

# Output: DJBookingSystem-Setup-v1.2.0.exe
```

---

## ?? Hostinger Server Setup

### **Step 1: Upload Files to Hostinger**

#### **A. Via File Manager (Easy)**

1. **Login to Hostinger Control Panel**
2. Go to **Files ? File Manager**
3. Navigate to `public_html` (or create `/updates` folder)
4. Create structure:
```
public_html/
??? updates/
?   ??? version.json
?   ??? installers/
?       ??? DJBookingSystem-Setup-v1.0.0.exe
?       ??? DJBookingSystem-Setup-v1.1.0.exe
?       ??? DJBookingSystem-Setup-v1.2.0.exe
```

5. **Upload files:**
   - Click **Upload**
   - Select files
   - Upload to `/updates/`

#### **B. Via FTP (Recommended)**

1. **Get FTP Credentials:**
   - Hostinger Panel ? Files ? FTP Accounts
   - Note: Host, Username, Password

2. **Use FileZilla:**
   - Download: https://filezilla-project.org/
   - Host: `ftp.yourdomain.com`
   - Username: Your FTP username
   - Password: Your FTP password
   - Port: `21`

3. **Upload structure:**
```
Remote site: /public_html/updates/
??? version.json
??? installers/
    ??? DJBookingSystem-Setup-v1.2.0.exe
```

---

### **Step 2: Create version.json**

Create `/public_html/updates/version.json`:

```json
{
  "updateAvailable": true,
  "currentVersion": "1.0.0",
  "latestVersion": "1.2.0",
  "releaseDate": "2025-01-15T10:00:00Z",
  "downloadUrl": "https://yourdomain.com/updates/installers/DJBookingSystem-Setup-v1.2.0.exe",
  "changelogUrl": "https://yourdomain.com/updates/changelog.html",
  "releaseNotes": "Major update with Discord integration and hourly auto-updates",
  "features": [
    "Discord WebView2 integration with auto-login",
    "Hourly automatic forced updates",
    "Improved UI performance",
    "Chat mode selection dialog",
    "75% default zoom for Discord"
  ],
  "bugFixes": [
    "Fixed WebView2 initialization error",
    "Fixed online status tracking",
    "Fixed auto-login issues",
    "Resolved freezing on bookings view"
  ],
  "isCritical": true,
  "minimumVersion": "1.0.0",
  "isSecureConnection": true,
  "fileSize": 125829120,
  "sha256Hash": "YOUR_FILE_HASH_HERE"
}
```

---

### **Step 3: Update Client Configuration**

In `Services\SecureUpdateClient.cs`:

```csharp
// Update server configuration
private const string UPDATE_SERVER_URL = "https://yourdomain.com";
private const string UPDATE_CHECK_ENDPOINT = "/updates/version.json";
private const string UPDATE_DOWNLOAD_ENDPOINT = "/updates/installers/";
```

**Replace `yourdomain.com` with your actual Hostinger domain!**

---

### **Step 4: SSL Certificate (IMPORTANT)**

Hostinger provides **FREE SSL certificates**:

1. **Enable SSL:**
   - Hostinger Panel ? Security ? SSL
   - Select domain
   - Click **Install SSL**
   - Choose **Free Let's Encrypt SSL**

2. **Get Certificate Fingerprint:**

**Option A: Browser Method**
1. Visit `https://yourdomain.com`
2. Click padlock icon ? Certificate ? Details
3. Copy SHA-256 fingerprint

**Option B: OpenSSL Command**
```bash
openssl s_client -connect yourdomain.com:443 < /dev/null 2>/dev/null | openssl x509 -fingerprint -sha256 -noout
```

3. **Update in Code:**

In `Services\SecureUpdateClient.cs`:
```csharp
private static readonly string[] TRUSTED_FINGERPRINTS = new[]
{
    "AA:BB:CC:DD:EE:FF:00:11:22:33:44:55:66:77:88:99:AA:BB:CC:DD:EE:FF:00:11:22:33:44:55:66:77:88:99",
    // Copy your actual SHA-256 fingerprint here
};
```

---

### **Step 5: Create API Endpoint (Optional but Recommended)**

Create `/public_html/updates/api/check.php`:

```php
<?php
header('Content-Type: application/json');
header('Access-Control-Allow-Origin: *');

// Get client version from header
$clientVersion = isset($_SERVER['HTTP_X_CLIENT_VERSION']) ? $_SERVER['HTTP_X_CLIENT_VERSION'] : '1.0.0';

// Current latest version
$latestVersion = '1.2.0';

// Check if update is available
$updateAvailable = version_compare($clientVersion, $latestVersion, '<');

// Response
$response = [
    'updateAvailable' => $updateAvailable,
    'currentVersion' => $clientVersion,
    'latestVersion' => $latestVersion,
    'releaseDate' => '2025-01-15T10:00:00Z',
    'downloadUrl' => 'https://yourdomain.com/updates/installers/DJBookingSystem-Setup-v' . $latestVersion . '.exe',
    'changelogUrl' => 'https://yourdomain.com/updates/changelog.html',
    'releaseNotes' => 'Major update with new features',
    'features' => [
        'Discord integration',
        'Hourly updates',
        'Improved performance'
    ],
    'bugFixes' => [
        'Fixed initialization errors',
        'Fixed status tracking'
    ],
    'isCritical' => true,
    'minimumVersion' => '1.0.0',
    'isSecureConnection' => true
];

echo json_encode($response, JSON_PRETTY_PRINT);
?>
```

**Then update client to use PHP endpoint:**
```csharp
private const string UPDATE_CHECK_ENDPOINT = "/updates/api/check.php";
```

---

## ?? Advanced Installer Customization

### **Custom Splash Screen**

Add to `installer.iss`:

```iss
[Code]
procedure ShowCustomSplash();
var
  SplashForm: TSetupForm;
  SplashImage: TBitmapImage;
begin
  SplashForm := CreateCustomForm();
  SplashForm.ClientWidth := 400;
  SplashForm.ClientHeight := 300;
  SplashForm.Center;
  SplashForm.BorderStyle := bsNone;
  
  SplashImage := TBitmapImage.Create(SplashForm);
  SplashImage.Parent := SplashForm;
  SplashImage.Bitmap.LoadFromFile(ExpandConstant('{tmp}\splash.bmp'));
  SplashImage.Align := alClient;
  
  SplashForm.Show;
  Sleep(2000);
  SplashForm.Close;
end;
```

---

### **Custom Progress Bar**

```iss
[Code]
procedure CurPageChanged(CurPageID: Integer);
begin
  if CurPageID = wpInstalling then
  begin
    // Custom progress bar color
    WizardForm.ProgressGauge.ForeColor := $00FF00; // Neon green
    WizardForm.ProgressGauge.BackColor := $0A0A0A; // Dark background
  end;
end;
```

---

### **Animated Logo**

```iss
[Code]
var
  LogoTimer: TTimer;
  LogoImage: TBitmapImage;
  LogoFrame: Integer;

procedure AnimateLogo(Sender: TObject);
begin
  LogoFrame := (LogoFrame + 1) mod 10;
  // Load next frame
  LogoImage.Bitmap.LoadFromFile(ExpandConstant('{tmp}\logo_' + IntToStr(LogoFrame) + '.bmp'));
end;

procedure InitializeWizard();
begin
  LogoFrame := 0;
  LogoImage := TBitmapImage.Create(WizardForm);
  LogoImage.Parent := WizardForm.WelcomePage;
  LogoImage.Top := 50;
  LogoImage.Left := 50;
  
  LogoTimer := TTimer.Create(WizardForm);
  LogoTimer.Interval := 100; // 100ms per frame
  LogoTimer.OnTimer := @AnimateLogo;
  LogoTimer.Enabled := True;
end;
```

---

## ?? Complete Workflow

### **1. Build Application**
```bash
dotnet publish -c Release -r win-x64 --self-contained
```

### **2. Create Installer**
```bash
# Open Inno Setup
iscc installer.iss

# Output: DJBookingSystem-Setup-v1.2.0.exe
```

### **3. Upload to Hostinger**
```bash
# Via FileZilla
ftp.yourdomain.com
Upload to: /public_html/updates/installers/
```

### **4. Update version.json**
```json
{
  "latestVersion": "1.2.0",
  "downloadUrl": "https://yourdomain.com/updates/installers/DJBookingSystem-Setup-v1.2.0.exe"
}
```

### **5. Users Get Updated!**
```
[Next hour on the hour]
All apps check ? Find v1.2.0 ? Forced download ? Install ? Done!
```

---

## ?? Bonus: Fancy Installer Features

### **1. Silent Install Mode**
```bash
DJBookingSystem-Setup-v1.2.0.exe /SILENT
```

### **2. Custom Install Location**
```bash
DJBookingSystem-Setup-v1.2.0.exe /DIR="C:\CustomPath"
```

### **3. No Desktop Icon**
```bash
DJBookingSystem-Setup-v1.2.0.exe /TASKS="!desktopicon"
```

### **4. Unattended Install**
```bash
DJBookingSystem-Setup-v1.2.0.exe /VERYSILENT /NORESTART
```

---

## ?? Final Checklist

### **Graphics:**
- [ ] Create WizardImage.bmp (164x314)
- [ ] Create WizardSmallImage.bmp (55x55)
- [ ] Create SetupIcon.ico (256x256)
- [ ] Match space/neon green theme

### **Installer:**
- [ ] Install Inno Setup
- [ ] Create installer.iss script
- [ ] Add custom colors and branding
- [ ] Build installer executable

### **Hostinger:**
- [ ] Upload installer to `/updates/installers/`
- [ ] Create version.json
- [ ] Enable SSL certificate
- [ ] Get SSL fingerprint
- [ ] Test download link

### **Client:**
- [ ] Update UPDATE_SERVER_URL
- [ ] Add SSL fingerprint
- [ ] Test update check
- [ ] Verify forced download works

---

## ?? Quick Start Commands

### **Build Installer:**
```bash
"C:\Program Files (x86)\Inno Setup 6\ISCC.exe" installer.iss
```

### **Upload to Hostinger:**
```bash
# Using WinSCP
winscp.com /command "open ftp://username@ftp.yourdomain.com" "put DJBookingSystem-Setup-v1.2.0.exe /public_html/updates/installers/" "exit"
```

### **Test Update:**
```csharp
// In your app
await UpdateManager.CheckForUpdatesOnStartupAsync(showNotifications: true, forceDownload: true);
```

---

## ?? Support Resources

| Need | Resource |
|------|----------|
| Inno Setup Help | https://jrsoftware.org/ishelp/ |
| Graphics Templates | https://canva.com |
| Icon Generator | https://icon-generator.net |
| Hostinger Docs | https://support.hostinger.com |
| FTP Client | https://filezilla-project.org |

---

**Status**: ?? **Ready to Create Fancy Installer + Hostinger Setup!**

**Your URLs:**
- Update Check: `https://yourdomain.com/updates/version.json`
- Installer Download: `https://yourdomain.com/updates/installers/DJBookingSystem-Setup-v1.2.0.exe`

**Users Experience:**
```
[Download fancy installer]
? See custom graphics and branding
? Smooth animated installation
? Launch with desktop icon
? Auto-update every hour!
```

?? **Ready to Build!**
