# ? IMMEDIATE ACTION PLAN - Phase 1 Critical Features

## ?? Goal: Complete Phase 1 in Current Session

### Priority Order:
1. Remove debug message box ? Easy (5 min)
2. Fix LoginWindow layout ? Medium (20 min)
3. Add Auto Login feature ? Medium (30 min)
4. Add 4 Claudes to SplashScreen ? Medium (20 min)
5. Add connection logic to SplashScreen ? Hard (30 min)
6. Add 4 Claudes to LoginWindow ? Easy (10 min)

**Total Estimated Time**: ~2 hours

---

## ? Task 1: Remove Debug MessageBox

### Location: `App.xaml.cs`
Find and remove any MessageBox.Show() after splash screen closes.

### Search for:
```csharp
MessageBox.Show(
```

### Action:
- Comment out or delete debug MessageBox calls
- Keep error MessageBox for critical failures only

---

## ? Task 2: Fix LoginWindow Layout

### Issues to Fix:
1. **Login button positioning** - currently obstructed
2. **Username textbox size** - make uniform with password box
3. **Password textbox size** - make uniform with username box
4. **Text formatting** - proper padding and font size
5. **Center all elements** - proper alignment

### File: `LoginWindow.xaml`

### Changes Needed:
```xaml
<!-- Username TextBox -->
<TextBox x:Name="UsernameTextBox"
         Height="45"  <!-- Uniform height -->
         Padding="12"  <!-- Proper padding -->
         FontSize="14"
         Margin="109,474,95,0"  <!-- Adjust positioning -->
         VerticalAlignment="Top"/>

<!-- Password PasswordBox -->
<PasswordBox x:Name="PasswordBox"
             Height="45"  <!-- Match username box -->
             Padding="12"  <!-- Match padding -->
             FontSize="14"
             Margin="109,540,95,0"  <!-- Position below username -->
             VerticalAlignment="Top"/>

<!-- Remember Me -->
<CheckBox x:Name="RememberMeCheckBox"
          Margin="109,600,0,0"  <!-- Position below password -->
          VerticalAlignment="Top"
          HorizontalAlignment="Left"/>

<!-- Auto Login (NEW) -->
<CheckBox x:Name="AutoLoginCheckBox"
          Content="Auto Login"
          Margin="250,600,0,0"  <!-- Next to Remember Me -->
          VerticalAlignment="Top"
          HorizontalAlignment="Left"
          IsEnabled="{Binding IsChecked, ElementName=RememberMeCheckBox}"/>

<!-- Login Button -->
<Button x:Name="LoginButton"
        Content="Login"
        Margin="109,650,95,0"  <!-- Clear space below checkboxes -->
        Height="50"
        VerticalAlignment="Top"/>
```

---

## ? Task 3: Add Auto Login Feature

### Files to Modify:
1. `LoginWindow.xaml` - Add checkbox
2. `LoginWindow.xaml.cs` - Add logic
3. `Utilities/LocalStorage.cs` - Add storage
4. `App.xaml.cs` - Add auto-login check

### LoginWindow.xaml.cs Changes:
```csharp
private void RememberMeCheckBox_Checked(object sender, RoutedEventArgs e)
{
    // Enable Auto Login checkbox
    AutoLoginCheckBox.IsEnabled = true;
}

private void RememberMeCheckBox_Unchecked(object sender, RoutedEventArgs e)
{
    // Disable and uncheck Auto Login
    AutoLoginCheckBox.IsEnabled = false;
    AutoLoginCheckBox.IsChecked = false;
}

private void AutoLoginCheckBox_Checked(object sender, RoutedEventArgs e)
{
    // Save auto login preference
    var loginInfo = LocalStorage.GetLoginInfo();
    if (loginInfo != null)
    {
        loginInfo.AutoLogin = true;
        LocalStorage.SaveLoginInfo(loginInfo);
    }
}
```

### LocalStorage.cs Changes:
```csharp
public class LoginInfo
{
    public string Username { get; set; }
    public string PasswordHash { get; set; }  // Store hashed password
    public bool RememberMe { get; set; }
    public bool AutoLogin { get; set; }  // NEW
}
```

### App.xaml.cs Changes:
```csharp
private async Task InitializeApplicationAsync()
{
    // Show splash first
    // ...
    
    // Check for auto login
    var loginInfo = LocalStorage.GetLoginInfo();
    if (loginInfo?.AutoLogin == true && !string.IsNullOrEmpty(loginInfo.Username))
    {
        // Attempt auto login
        var user = await _globalCosmosDbService.AuthenticateUserAsync(
            loginInfo.Username, 
            loginInfo.PasswordHash,
            isHashedPassword: true);
            
        if (user != null)
        {
            // Auto login successful - go straight to MainWindow
            var mainWindow = new MainWindow(user, _globalCosmosDbService);
            mainWindow.Show();
            return;  // Skip login window
        }
    }
    
    // Show login window if auto login failed or not enabled
    var loginWindow = new LoginWindow(_globalCosmosDbService);
    loginWindow.ShowDialog();
    // ...
}
```

---

## ? Task 4: Add 4 Claudes to SplashScreen

### File: `SplashScreen.xaml`

### Add at top of content (after logo):
```xaml
<!-- Connection Status Indicators -->
<StackPanel Grid.Row="0" 
            Orientation="Horizontal" 
            HorizontalAlignment="Center"
            Margin="0,10,0,20">
    <controls:ClaudeIndicator x:Name="CosmosIndicator"
                              ServiceName="Azure Cosmos DB"
                              LabelText="Cosmos"
                              Margin="8,0"/>
    <controls:ClaudeIndicator x:Name="LPMIndicator"
                              ServiceName="Live Party Music"
                              LabelText="LPM.fm"
                              Margin="8,0"/>
    <controls:ClaudeIndicator x:Name="RadioBossIndicator"
                              ServiceName="RadioBOSS Control"
                              LabelText="Booking"
                              Margin="8,0"/>
    <controls:ClaudeIndicator x:Name="StreamIndicator"
                              ServiceName="RadioBOSS Stream"
                              LabelText="Live Status"
                              Margin="8,0"/>
</StackPanel>
```

---

## ? Task 5: Add Connection Logic to SplashScreen

### File: `SplashScreen.xaml.cs`

### Add Connection Checking:
```csharp
private CosmosDbService? _cosmosService;
private bool _allConnectionsReady = false;

public SplashScreen(CosmosDbService? cosmosService = null)
{
    InitializeComponent();
    _cosmosService = cosmosService;
    Loaded += SplashScreen_Loaded;
}

private async void SplashScreen_Loaded(object sender, RoutedEventArgs e)
{
    // Set all to connecting (yellow)
    CosmosIndicator.SetConnecting();
    LPMIndicator.SetConnecting();
    RadioBossIndicator.SetConnecting();
    StreamIndicator.SetConnecting();
    
    // Start progress animation
    StartProgressAnimation();
    
    // Check connections in parallel
    await CheckAllConnectionsAsync();
}

private async Task CheckAllConnectionsAsync()
{
    // Check all 4 services
    var results = await ConnectionService.CheckAllConnectionsAsync(_cosmosService);
    
    // Update indicators
    Dispatcher.Invoke(() =>
    {
        CosmosIndicator.IsConnected = results.CosmosDbConnected;
        LPMIndicator.IsConnected = results.LivePartyMusicConnected;
        RadioBossIndicator.IsConnected = results.RadioBossControlConnected;
        StreamIndicator.IsConnected = results.RadioBossStreamActive;
        
        _allConnectionsReady = results.AllConnected;
    });
}

private void StartProgressAnimation()
{
    var timer = new DispatcherTimer 
    { 
        Interval = TimeSpan.FromMilliseconds(100) 
    };
    
    timer.Tick += (s, e) =>
    {
        _currentProgress += 1;
        
        // Block at 90% until connections ready
        if (_currentProgress >= 90 && !_allConnectionsReady)
        {
            // Wait for connections
            return;
        }
        
        // Update UI
        UpdateProgress(_currentProgress);
        
        // Complete at 100%
        if (_currentProgress >= 100)
        {
            timer.Stop();
            _completionSource.SetResult(true);
            Close();
        }
    };
    
    timer.Start();
}
```

---

## ? Task 6: Add 4 Claudes to LoginWindow

### File: `LoginWindow.xaml`

### Add at top of Grid (Row 0):
```xaml
<!-- Connection Status Indicators -->
<StackPanel Grid.Row="0" 
            Orientation="Horizontal" 
            HorizontalAlignment="Center"
            Margin="0,5,0,10">
    <controls:ClaudeIndicator x:Name="CosmosIndicator"
                              ServiceName="Azure Cosmos DB"
                              LabelText="Cosmos"
                              IsConnected="True"
                              Margin="8,0"/>
    <controls:ClaudeIndicator x:Name="LPMIndicator"
                              ServiceName="Live Party Music"
                              LabelText="LPM.fm"
                              IsConnected="True"
                              Margin="8,0"/>
    <controls:ClaudeIndicator x:Name="RadioBossIndicator"
                              ServiceName="RadioBOSS Control"
                              LabelText="Booking"
                              IsConnected="True"
                              Margin="8,0"/>
    <controls:ClaudeIndicator x:Name="StreamIndicator"
                              ServiceName="RadioBOSS Stream"
                              LabelText="Live Status"
                              IsConnected="True"
                              Margin="8,0"/>
</StackPanel>
```

### Add Periodic Connection Check:
```csharp
private DispatcherTimer _connectionCheckTimer;

public LoginWindow(object? dataService)
{
    InitializeComponent();
    _dataService = dataService;
    
    // Start periodic connection checks (every 30 seconds)
    _connectionCheckTimer = new DispatcherTimer 
    { 
        Interval = TimeSpan.FromSeconds(30) 
    };
    _connectionCheckTimer.Tick += async (s, e) => await CheckConnectionsAsync();
    _connectionCheckTimer.Start();
}

private async Task CheckConnectionsAsync()
{
    var results = await ConnectionService.CheckAllConnectionsAsync(_dataService as CosmosDbService);
    
    Dispatcher.Invoke(() =>
    {
        CosmosIndicator.IsConnected = results.CosmosDbConnected;
        LPMIndicator.IsConnected = results.LivePartyMusicConnected;
        RadioBossIndicator.IsConnected = results.RadioBossControlConnected;
        StreamIndicator.IsConnected = results.RadioBossStreamActive;
    });
}
```

---

## ?? Implementation Order

### Step 1: Debug MessageBox (5 min)
Search and remove/comment debug MessageBox in App.xaml.cs

### Step 2: Fix LoginWindow Layout (20 min)
Update LoginWindow.xaml with proper positioning and sizing

### Step 3: Auto Login Backend (15 min)
Update LocalStorage.cs with AutoLogin property

### Step 4: Auto Login Frontend (15 min)
Add checkbox and logic to LoginWindow

### Step 5: Auto Login Integration (10 min)
Update App.xaml.cs to check for auto login

### Step 6: SplashScreen Claudes (15 min)
Add 4 ClaudeIndicators to SplashScreen.xaml

### Step 7: SplashScreen Logic (25 min)
Add connection checking to SplashScreen.xaml.cs

### Step 8: LoginWindow Claudes (10 min)
Add 4 ClaudeIndicators to LoginWindow.xaml

### Step 9: LoginWindow Monitoring (10 min)
Add periodic connection checks to LoginWindow.xaml.cs

---

## ? Ready to Implement!

All tasks are defined and ready for implementation. 
Estimated completion: ~2 hours
Status: ? Awaiting execution

---

**Priority**: ?? CRITICAL  
**Phase**: 1 - Connection & UI  
**Dependencies**: None  
**Blocking**: All other features depend on Phase 1
