# âœ… RADIOBOSS API UPDATED - c4 â†’ c40

## CRITICAL CHANGES APPLIED

### OLD (REMOVED):
```
URL: https://c4.radioboss.fm/api/info/560?key=9CT2KPOHAG9N
```

### NEW (UPDATED):
```
URL: https://c40.radioboss.fm/api/info/98?key=8VTO5355BZ5X
Base: https://c40.radioboss.fm
Endpoint: /api/info/98
API Key: 8VTO5355BZ5X
Station ID: 560 (still used for search/request functions)
```

---

## FILES UPDATED (5 Files)

### 1. âœ… appsettings.json
**Changes:**
- Added `"ApiEndpointId": "98"`
- Added `"ApiKey": "8VTO5355BZ5X"`
- Updated StatusIndicators endpoint
- All URLs already c40 (no c4 references found)

**Configuration:**
```json
"RadioBOSS": {
  "BaseUrl": "https://c40.radioboss.fm",
  "ApiEndpointId": "98",
  "ApiKey": "8VTO5355BZ5X",
  "StationId": "560",
  "StreamUrl": "https://stream.radioboss.fm:18052/stream",
  "WebInterfaceUrl": "https://c40.radioboss.fm/#main",
  "ApiTimeout": 10
}
```

### 2. âœ… Services/RadioBossAPIService.cs
**Changes:**
- Added `_apiKey` field
- Added `_apiEndpointId` field
- Updated `GetCurrentTrack()` to use new API format
- Updated `GetStreamInfo()` to use new API format
- Updated class documentation

**New API Calls:**
```csharp
// Current Track
$"{_baseUrl}/api/info/{_apiEndpointId}?key={_apiKey}"

// Stream Info
$"{_baseUrl}/api/info/{_apiEndpointId}?key={_apiKey}"
```

### 3. âœ… README.md
**Changes:**
- Added API Endpoint and Key to credentials section

**Updated Section:**
```markdown
### RadioBOSS Station
Station ID: 560
Base URL: https://c40.radioboss.fm
API Endpoint: /api/info/98
API Key: 8VTO5355BZ5X
Control Panel: https://c40.radioboss.fm/#main
```

### 4. âœ… wwwroot/index.html
**Changes:**
- RadioBOSS iframe already uses c40 (correct)

**Iframe Source:**
```html
<iframe src="https://c40.radioboss.fm/#main"></iframe>
```

### 5. âœ… Status Indicators
**Updated Endpoint:**
```json
"StatusIndicators": {
  "RadioBOSS": {
    "Endpoint": "https://c40.radioboss.fm/api/info/98?key=8VTO5355BZ5X"
  }
}
```

---

## WHAT STILL USES STATION ID 560?

**These functions still use Station ID 560 (CORRECT):**
- Song Search: `https://c40.radioboss.fm/w/songrequestsearch?u=560&q={query}`
- Song Request: `https://c40.radioboss.fm/w/songrequest?u=560&id={trackId}`
- Track History: `https://c40.radioboss.fm/w/trackhistory?u=560`

**Note:** These are DIFFERENT endpoints and still use the `u=560` parameter format.

---

## API ENDPOINTS SUMMARY

### New Info API (uses Endpoint ID 98 + Key)
```
GET https://c40.radioboss.fm/api/info/98?key=8VTO5355BZ5X
Returns: Current track, stream info, listeners
```

### Legacy Web Endpoints (still use Station ID 560)
```
GET https://c40.radioboss.fm/w/songrequestsearch?u=560&q={query}
GET https://c40.radioboss.fm/w/songrequest?u=560&id={trackId}
GET https://c40.radioboss.fm/w/trackhistory?u=560&limit={limit}
```

---

## TESTING CHECKLIST

After deployment, test these features:

### âœ… Current Track Info
- Navigate to any page that displays "Now Playing"
- Should fetch from: `https://c40.radioboss.fm/api/info/98?key=8VTO5355BZ5X`
- Should display: Title, Artist, Album, Listeners

### âœ… Stream Info
- Check RadioBOSS status indicator (top bar)
- Should show: ðŸŸ¢ Online or ðŸ”´ Offline
- Endpoint: `https://c40.radioboss.fm/api/info/98?key=8VTO5355BZ5X`

### âœ… Song Search (still uses Station 560)
- Try song request feature
- Search endpoint: `https://c40.radioboss.fm/w/songrequestsearch?u=560&q=test`
- Should return: List of matching songs

### âœ… RadioBOSS Control Panel
- Navigate to Tab 3 (RadioBOSS)
- Iframe should load: `https://c40.radioboss.fm/#main`
- Should display: Full RadioBOSS web interface

---

## NO FURTHER CHANGES NEEDED

All RadioBOSS API references have been updated to the new format.

**Summary:**
- âœ… c4 â†’ c40 (all references updated)
- âœ… Old API format removed
- âœ… New API endpoint (98) configured
- âœ… API Key (8VTO5355BZ5X) added
- âœ… Station ID (560) retained for legacy endpoints

**Status:** ðŸŸ¢ READY TO DEPLOY

---

## IF YOU GET API ERRORS

### Error: 401 Unauthorized
- Check API key is correct: `8VTO5355BZ5X`
- Verify endpoint ID is: `98`

### Error: 404 Not Found
- Verify base URL is: `https://c40.radioboss.fm`
- Check endpoint format: `/api/info/98?key=8VTO5355BZ5X`

### Error: Connection Failed
- Check network connectivity
- Verify firewall allows HTTPS to c40.radioboss.fm
- Test URL in browser: https://c40.radioboss.fm/api/info/98?key=8VTO5355BZ5X

---

**Last Updated:** November 13, 2025  
**RadioBOSS API Version:** c40 (Current)
