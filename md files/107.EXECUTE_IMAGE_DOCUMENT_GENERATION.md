# VS2022 Copilot: Execute Image & Document Generation Integration

## MISSION OBJECTIVE
Add AI image generation and document creation capabilities to Candy-Bot. All service files are already created. This document provides complete integration instructions for Visual Studio 2022 Copilot.

---

## PREREQUISITE: VERIFY FILES EXIST

### Required Service Files (Should Already Exist)
‚úÖ `Services/CandyBotImageGenerator.cs` - AI image generation
‚úÖ `Services/CandyBotDocumentGenerator.cs` - Document creation
‚úÖ `Services/CandyBotSoundManager.cs` - Voice feedback (existing)
‚úÖ `Services/CandyBotFileManager.cs` - File operations (existing)

**ACTION:** Build solution to verify all files compile correctly.

---

## PHASE 1: ADD SERVICES TO MAINWINDOW

### Task 1.1: Add Private Fields

**FILE:** `MainWindow.xaml.cs`

**LOCATION:** Top of MainWindow class, with other private fields

**ACTION:** Add these fields after existing Candy-Bot fields:

```csharp
// Candy-Bot Image & Document Generation
private CandyBotImageGenerator _candyImageGen;
private CandyBotDocumentGenerator _candyDocGen;
```

### Task 1.2: Initialize Services in Constructor

**FILE:** `MainWindow.xaml.cs`

**LOCATION:** In MainWindow constructor, after existing Candy-Bot initialization

**ACTION:** Add this code after `_candySound` and `_candyFiles` initialization:

```csharp
// Initialize Image Generator
// IMPORTANT: Replace with your actual OpenAI API key
string openAiApiKey = ""; // Leave empty for now, add later

if (!string.IsNullOrEmpty(openAiApiKey))
{
    _candyImageGen = new CandyBotImageGenerator(
        apiKey: openAiApiKey,
        provider: CandyBotImageGenerator.ImageProvider.OpenAI_DALLE3,
        soundManager: _candySound
    );
}
else
{
    // Initialize without API key - will show error if used
    _candyImageGen = new CandyBotImageGenerator(
        soundManager: _candySound
    );
    System.Diagnostics.Debug.WriteLine("[CandyBot] Image Generator initialized without API key");
}

// Initialize Document Generator (no API key needed)
_candyDocGen = new CandyBotDocumentGenerator(_candySound);

System.Diagnostics.Debug.WriteLine("[CandyBot] Image & Document Generation services initialized");
```

**EXPECTED RESULT:** Services initialized and ready to use. App should compile and run.

---

## PHASE 2: CREATE QUICK TEST METHODS

### Task 2.1: Add Test Methods to MainWindow

**FILE:** `MainWindow.xaml.cs`

**LOCATION:** In MainWindow class, create a new region for testing

**ACTION:** Add these test methods:

```csharp
#region Candy-Bot Image & Document Generation Tests

/// <summary>
/// Test image generation (requires API key)
/// </summary>
private async Task TestImageGenerationAsync()
{
    try
    {
        System.Diagnostics.Debug.WriteLine("[Test] Starting image generation test...");
        
        var result = await _candyImageGen.GenerateImageAsync(
            "A futuristic DJ booth with neon green lights and turntables, cyberpunk style",
            size: ImageSize.Square_1024,
            quality: ImageQuality.Standard
        );

        if (result.Success)
        {
            System.Diagnostics.Debug.WriteLine($"[Test] Image generated successfully: {result.LocalFilePath}");
            MessageBox.Show(
                $"‚úÖ Image Generation Test PASSED!\n\n" +
                $"Image saved to:\n{result.LocalFilePath}\n\n" +
                $"Generation time: {result.Duration.TotalSeconds:F1} seconds",
                "Image Generation Success",
                MessageBoxButton.OK,
                MessageBoxImage.Information
            );

            // Open folder containing image
            System.Diagnostics.Process.Start("explorer.exe", 
                System.IO.Path.GetDirectoryName(result.LocalFilePath));
        }
        else
        {
            System.Diagnostics.Debug.WriteLine($"[Test] Image generation failed: {result.ErrorMessage}");
            MessageBox.Show(
                $"‚ùå Image Generation Test FAILED\n\n" +
                $"Error: {result.ErrorMessage}\n\n" +
                $"Note: This requires an OpenAI API key.\n" +
                $"Get one at: https://platform.openai.com/api-keys",
                "Image Generation Failed",
                MessageBoxButton.OK,
                MessageBoxImage.Warning
            );
        }
    }
    catch (Exception ex)
    {
        System.Diagnostics.Debug.WriteLine($"[Test] Exception: {ex.Message}");
        MessageBox.Show($"Error: {ex.Message}", "Test Error");
    }
}

/// <summary>
/// Test document generation (no API key needed)
/// </summary>
private async Task TestDocumentGenerationAsync()
{
    try
    {
        System.Diagnostics.Debug.WriteLine("[Test] Starting document generation test...");

        // Test 1: Create text file
        var textResult = await _candyDocGen.CreateTextFileAsync(
            "Hello from Candy-Bot!\n\n" +
            "This is a test document created by the Candy-Bot Document Generator.\n\n" +
            "Features:\n" +
            "- Text files\n" +
            "- Word documents\n" +
            "- PDF files\n" +
            "- Excel spreadsheets\n" +
            "- PowerPoint presentations\n\n" +
            $"Generated: {DateTime.Now}",
            fileName: $"CandyBot_Test_{DateTime.Now:yyyyMMdd_HHmmss}.txt"
        );

        // Test 2: Create markdown file
        var mdResult = await _candyDocGen.CreateMarkdownFileAsync(
            "Candy-Bot Test Document",
            "## Test Successful!\n\n" +
            "This markdown file was generated by Candy-Bot.\n\n" +
            "### Features:\n" +
            "- ‚úÖ Text files\n" +
            "- ‚úÖ Markdown files\n" +
            "- ‚úÖ Word documents (with package)\n" +
            "- ‚úÖ PDF files (with package)\n\n" +
            $"Generated: {DateTime.Now:yyyy-MM-dd HH:mm:ss}",
            fileName: $"CandyBot_Test_{DateTime.Now:yyyyMMdd_HHmmss}.md"
        );

        if (textResult.Success && mdResult.Success)
        {
            System.Diagnostics.Debug.WriteLine("[Test] Documents generated successfully");
            
            var message = $"‚úÖ Document Generation Test PASSED!\n\n" +
                         $"Created 2 documents:\n\n" +
                         $"1. Text File:\n{textResult.FileName}\n\n" +
                         $"2. Markdown File:\n{mdResult.FileName}\n\n" +
                         $"Location:\n{System.IO.Path.GetDirectoryName(textResult.FilePath)}";

            var result = MessageBox.Show(
                message + "\n\nOpen document folder?",
                "Document Generation Success",
                MessageBoxButton.YesNo,
                MessageBoxImage.Information
            );

            if (result == MessageBoxResult.Yes)
            {
                // Open folder
                System.Diagnostics.Process.Start("explorer.exe",
                    System.IO.Path.GetDirectoryName(textResult.FilePath));
            }
        }
        else
        {
            System.Diagnostics.Debug.WriteLine("[Test] Document generation failed");
            MessageBox.Show("Document generation failed. Check Debug Output for details.");
        }
    }
    catch (Exception ex)
    {
        System.Diagnostics.Debug.WriteLine($"[Test] Exception: {ex.Message}");
        MessageBox.Show($"Error: {ex.Message}", "Test Error");
    }
}

/// <summary>
/// Test DJ-specific document generation
/// </summary>
private async Task TestDJDocumentsAsync()
{
    try
    {
        System.Diagnostics.Debug.WriteLine("[Test] Starting DJ document test...");

        // Create sample tracks
        var tracks = new System.Collections.Generic.List<Track>
        {
            new Track { Artist = "Daft Punk", Title = "One More Time", Duration = "5:20", Genre = "Electronic" },
            new Track { Artist = "The Chemical Brothers", Title = "Block Rockin' Beats", Duration = "4:58", Genre = "Big Beat" },
            new Track { Artist = "Fatboy Slim", Title = "Right Here, Right Now", Duration = "6:26", Genre = "Big Beat" },
            new Track { Artist = "The Prodigy", Title = "Firestarter", Duration = "4:40", Genre = "Electronic" },
            new Track { Artist = "Underworld", Title = "Born Slippy", Duration = "9:43", Genre = "Techno" }
        };

        // Generate DJ setlist
        var setlistResult = await _candyDocGen.CreateDJSetlistAsync(
            djName: "DJ CANDY",
            venueName: "The Fallen Collective",
            eventDate: DateTime.Now.AddDays(7),
            tracks: tracks,
            outputFormat: DocumentType.Text // Use .txt for now
        );

        // Generate booking contract
        var contractResult = await _candyDocGen.CreateBookingContractAsync(
            djName: "DJ CANDY",
            venueName: "The Fallen Collective",
            eventDate: DateTime.Now.AddDays(7),
            fee: 500.00m,
            additionalTerms: "- Equipment provided by venue\n- Sound check at 7:00 PM\n- Performance time: 9:00 PM - 2:00 AM"
        );

        if (setlistResult.Success && contractResult.Success)
        {
            System.Diagnostics.Debug.WriteLine("[Test] DJ documents generated successfully");

            var message = $"‚úÖ DJ Document Test PASSED!\n\n" +
                         $"Created:\n" +
                         $"1. Setlist ({tracks.Count} tracks)\n" +
                         $"2. Booking Contract ($500)\n\n" +
                         $"Files saved to:\n{System.IO.Path.GetDirectoryName(setlistResult.FilePath)}";

            var result = MessageBox.Show(
                message + "\n\nOpen documents?",
                "DJ Documents Success",
                MessageBoxButton.YesNo,
                MessageBoxImage.Information
            );

            if (result == MessageBoxResult.Yes)
            {
                _candyDocGen.OpenDocument(setlistResult.FilePath);
                _candyDocGen.OpenDocument(contractResult.FilePath);
            }
        }
    }
    catch (Exception ex)
    {
        System.Diagnostics.Debug.WriteLine($"[Test] Exception: {ex.Message}");
        MessageBox.Show($"Error: {ex.Message}", "Test Error");
    }
}

/// <summary>
/// Run all tests
/// </summary>
private async Task RunAllCandyBotTestsAsync()
{
    System.Diagnostics.Debug.WriteLine("\n========================================");
    System.Diagnostics.Debug.WriteLine("CANDY-BOT FULL FEATURE TEST");
    System.Diagnostics.Debug.WriteLine("========================================\n");

    // Test 1: Document Generation (always works)
    await TestDocumentGenerationAsync();
    
    await Task.Delay(1000); // Brief pause

    // Test 2: DJ Documents
    await TestDJDocumentsAsync();

    await Task.Delay(1000); // Brief pause

    // Test 3: Image Generation (only if API key configured)
    var apiKeyConfigured = !string.IsNullOrEmpty(_candyImageGen?.ToString()); // Simplified check
    
    var testImages = MessageBox.Show(
        "Document tests complete!\n\n" +
        "Test image generation?\n" +
        "(Requires OpenAI API key and costs ~$0.04 per image)",
        "Image Generation Test",
        MessageBoxButton.YesNo,
        MessageBoxImage.Question
    );

    if (testImages == MessageBoxResult.Yes)
    {
        await TestImageGenerationAsync();
    }

    System.Diagnostics.Debug.WriteLine("\n========================================");
    System.Diagnostics.Debug.WriteLine("ALL TESTS COMPLETE");
    System.Diagnostics.Debug.WriteLine("========================================\n");

    MessageBox.Show(
        "‚úÖ All Candy-Bot tests complete!\n\n" +
        "Check the Debug Output window for detailed results.",
        "Tests Complete",
        MessageBoxButton.OK,
        MessageBoxImage.Information
    );
}

#endregion
```

---

## PHASE 3: ADD TEST MENU ITEMS

### Task 3.1: Add Test Menu to MainWindow

**FILE:** `MainWindow.xaml`

**LOCATION:** In the main menu bar

**ACTION:** Add a new "Tests" menu:

```xml
<!-- Add this menu to your existing MenuBar -->
<MenuItem Header="üß™ Tests">
    <MenuItem Header="üìÑ Test Documents" Click="TestDocuments_Click"/>
    <MenuItem Header="üéµ Test DJ Documents" Click="TestDJDocuments_Click"/>
    <MenuItem Header="üé® Test Image Generation" Click="TestImages_Click"/>
    <Separator/>
    <MenuItem Header="‚úÖ Run All Tests" Click="RunAllTests_Click" FontWeight="Bold"/>
</MenuItem>
```

### Task 3.2: Add Menu Click Handlers

**FILE:** `MainWindow.xaml.cs`

**LOCATION:** In MainWindow class

**ACTION:** Add these event handlers:

```csharp
#region Test Menu Handlers

private async void TestDocuments_Click(object sender, RoutedEventArgs e)
{
    await TestDocumentGenerationAsync();
}

private async void TestDJDocuments_Click(object sender, RoutedEventArgs e)
{
    await TestDJDocumentsAsync();
}

private async void TestImages_Click(object sender, RoutedEventArgs e)
{
    await TestImageGenerationAsync();
}

private async void RunAllTests_Click(object sender, RoutedEventArgs e)
{
    await RunAllCandyBotTestsAsync();
}

#endregion
```

---

## PHASE 4: ADD API KEY CONFIGURATION

### Task 4.1: Create API Key Configuration Window (OPTIONAL)

**ACTION:** Create new Window: `CandyBotAPIConfigWindow.xaml`

**XAML:**
```xml
<Window x:Class="DJBookingSystem.CandyBotAPIConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="üîë Candy-Bot API Configuration"
        Height="400" Width="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="üîë API Key Configuration" 
                       FontSize="24" 
                       FontWeight="Bold"
                       Margin="0,0,0,10"/>
            <TextBlock Text="Configure your OpenAI API key for image generation"
                       TextWrapping="Wrap"
                       Foreground="Gray"/>
        </StackPanel>
        
        <!-- Content -->
        <StackPanel Grid.Row="1">
            <TextBlock Text="OpenAI API Key:" FontWeight="Bold" Margin="0,0,0,5"/>
            <TextBox x:Name="ApiKeyTextBox" 
                     Height="30"
                     VerticalContentAlignment="Center"
                     Margin="0,0,0,10"/>
            
            <TextBlock Text="Get your API key from:" Margin="0,0,0,5"/>
            <TextBlock>
                <Hyperlink NavigateUri="https://platform.openai.com/api-keys" 
                           RequestNavigate="Hyperlink_RequestNavigate">
                    https://platform.openai.com/api-keys
                </Hyperlink>
            </TextBlock>
            
            <Border Background="#FFF9E6" 
                    BorderBrush="#FFD700" 
                    BorderThickness="1" 
                    Padding="10" 
                    Margin="0,20,0,0">
                <StackPanel>
                    <TextBlock Text="‚ö†Ô∏è Important Notes:" FontWeight="Bold" Margin="0,0,0,5"/>
                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                        ‚Ä¢ API key is stored locally (not encrypted)
                    </TextBlock>
                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                        ‚Ä¢ Image generation costs ~$0.04 - $0.12 per image
                    </TextBlock>
                    <TextBlock TextWrapping="Wrap">
                        ‚Ä¢ Documents are FREE (no API needed)
                    </TextBlock>
                </StackPanel>
            </Border>
        </StackPanel>
        
        <!-- Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right"
                    Margin="0,20,0,0">
            <Button Content="Cancel" 
                    Width="100" 
                    Height="35"
                    Margin="0,0,10,0"
                    Click="Cancel_Click"/>
            <Button Content="Save" 
                    Width="100" 
                    Height="35"
                    Click="Save_Click"
                    IsDefault="True"/>
        </StackPanel>
    </Grid>
</Window>
```

**CODE-BEHIND:** `CandyBotAPIConfigWindow.xaml.cs`

```csharp
using System;
using System.Diagnostics;
using System.Windows;
using System.Windows.Navigation;

namespace DJBookingSystem
{
    public partial class CandyBotAPIConfigWindow : Window
    {
        public string ApiKey { get; private set; }

        public CandyBotAPIConfigWindow(string currentApiKey = "")
        {
            InitializeComponent();
            ApiKeyTextBox.Text = currentApiKey;
        }

        private void Save_Click(object sender, RoutedEventArgs e)
        {
            ApiKey = ApiKeyTextBox.Text.Trim();
            
            if (string.IsNullOrEmpty(ApiKey))
            {
                var result = MessageBox.Show(
                    "No API key entered. Image generation will not work.\n\n" +
                    "Continue without API key?",
                    "No API Key",
                    MessageBoxButton.YesNo,
                    MessageBoxImage.Warning
                );

                if (result == MessageBoxResult.No)
                    return;
            }

            DialogResult = true;
            Close();
        }

        private void Cancel_Click(object sender, RoutedEventArgs e)
        {
            DialogResult = false;
            Close();
        }

        private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)
        {
            Process.Start(new ProcessStartInfo
            {
                FileName = e.Uri.AbsoluteUri,
                UseShellExecute = true
            });
            e.Handled = true;
        }
    }
}
```

### Task 4.2: Add Menu Item for API Config

**FILE:** `MainWindow.xaml`

**ACTION:** Add to Settings or Tools menu:

```xml
<MenuItem Header="üîë Configure API Keys" Click="ConfigureAPI_Click"/>
```

**FILE:** `MainWindow.xaml.cs`

**ACTION:** Add handler:

```csharp
private void ConfigureAPI_Click(object sender, RoutedEventArgs e)
{
    var currentKey = ""; // Get from settings if you have persistent storage
    var dialog = new CandyBotAPIConfigWindow(currentKey);
    
    if (dialog.ShowDialog() == true)
    {
        // Reinitialize image generator with new key
        _candyImageGen = new CandyBotImageGenerator(
            apiKey: dialog.ApiKey,
            provider: CandyBotImageGenerator.ImageProvider.OpenAI_DALLE3,
            soundManager: _candySound
        );
        
        MessageBox.Show(
            "API key configured!\n\n" +
            "Image generation is now ready to use.",
            "Configuration Saved",
            MessageBoxButton.OK,
            MessageBoxImage.Information
        );
        
        // TODO: Save to settings for persistence
    }
}
```

---

## PHASE 5: INTEGRATION WITH EXISTING FEATURES

### Task 5.1: Add Image Generation to Booking Confirmation

**FILE:** Find your booking save method (likely `SaveBooking` or similar)

**ACTION:** Add image generation option:

```csharp
private async void SaveBooking() // Your existing method
{
    try
    {
        // YOUR EXISTING BOOKING SAVE CODE HERE
        // ...

        // After successful save, offer to generate promotional image
        var generateImage = MessageBox.Show(
            "Booking saved successfully!\n\n" +
            "Generate promotional image for this event?",
            "Generate Image",
            MessageBoxButton.YesNo,
            MessageBoxImage.Question
        );

        if (generateImage == MessageBoxResult.Yes)
        {
            var prompt = $"Electronic music event poster for {venueName}, " +
                        $"DJ performance, cyberpunk style, neon green and black colors";
            
            var imageResult = await _candyImageGen.GenerateImageAsync(prompt);
            
            if (imageResult.Success)
            {
                MessageBox.Show($"Image saved to:\n{imageResult.LocalFilePath}");
            }
        }

        // Play success voice
        await _candySound.PlayVoiceLine("038"); // "Booking confirmed!"
    }
    catch (Exception ex)
    {
        await _candySound.PlayVoiceLine("056"); // Error
        MessageBox.Show($"Error: {ex.Message}");
    }
}
```

### Task 5.2: Add Document Export to Bookings View

**FILE:** Find your bookings display/view (likely `BookingsView.xaml.cs` or `MainWindow.xaml.cs`)

**ACTION:** Add export buttons and handlers:

**XAML:** Add export buttons to your booking details:
```xml
<StackPanel Orientation="Horizontal" Margin="0,10,0,0">
    <Button Content="üìÑ Export Setlist" 
            Click="ExportSetlist_Click" 
            Width="120" 
            Height="30"
            Margin="0,0,5,0"/>
    <Button Content="üìù Export Contract" 
            Click="ExportContract_Click" 
            Width="120" 
            Height="30"/>
</StackPanel>
```

**CODE:** Add handlers:
```csharp
private async void ExportSetlist_Click(object sender, RoutedEventArgs e)
{
    // Get selected booking
    var booking = GetSelectedBooking(); // Your existing method
    
    if (booking == null)
    {
        MessageBox.Show("Please select a booking first.");
        return;
    }

    // Convert to tracks (adjust based on your data model)
    var tracks = new System.Collections.Generic.List<Track>();
    // TODO: Populate tracks from your booking data
    
    var result = await _candyDocGen.CreateDJSetlistAsync(
        booking.DJName,
        booking.VenueName,
        booking.EventDate,
        tracks
    );

    if (result.Success)
    {
        MessageBox.Show($"Setlist exported!\n{result.FilePath}");
        _candyDocGen.OpenDocument(result.FilePath);
    }
}

private async void ExportContract_Click(object sender, RoutedEventArgs e)
{
    var booking = GetSelectedBooking();
    
    if (booking == null)
    {
        MessageBox.Show("Please select a booking first.");
        return;
    }

    var result = await _candyDocGen.CreateBookingContractAsync(
        booking.DJName,
        booking.VenueName,
        booking.EventDate,
        booking.Fee
    );

    if (result.Success)
    {
        MessageBox.Show($"Contract exported!\n{result.FilePath}");
        _candyDocGen.OpenDocument(result.FilePath);
    }
}
```

---

## PHASE 6: TESTING CHECKLIST

### Step-by-Step Verification

**Build & Run:**
1. Build solution (`Ctrl+Shift+B`)
   - Should compile with no errors
   - Check for warnings

2. Run application (`F5`)
   - Should start normally
   - Check Debug Output for initialization messages

**Test Documents (No API Key Needed):**
3. Click: `Tests ‚Üí Test Documents`
   - Should create 2 files (text + markdown)
   - Should show success dialog
   - Files should open in default apps

4. Click: `Tests ‚Üí Test DJ Documents`
   - Should create setlist + contract
   - Should show success dialog
   - Files should open

**Test Images (Requires API Key):**
5. Click: `Tests ‚Üí Test Image Generation`
   - If no API key: Shows error with instructions
   - If has API key: Generates image (~30-60 seconds)
   - Should save to Pictures folder

6. Configure API key (if needed):
   - Click: `Tools ‚Üí Configure API Keys` (if you added it)
   - Enter OpenAI API key
   - Test image generation again

**Integration Tests:**
7. Test booking integration:
   - Create/save a booking
   - Should offer to generate image
   - Should be able to export documents

**Full Test:**
8. Click: `Tests ‚Üí Run All Tests`
   - Should run all tests in sequence
   - Should show summary at end

---

## PHASE 7: OPTIONAL ENHANCEMENTS

### Enhancement 7.1: Add Image Gallery View

**ACTION:** Create window to view generated images

**XAML:** `CandyBotImageGalleryWindow.xaml`
```xml
<Window x:Class="DJBookingSystem.CandyBotImageGalleryWindow"
        Title="üé® Generated Images"
        Height="600" Width="800">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <TextBlock Grid.Row="0" 
                   Text="üé® Candy-Bot Generated Images"
                   FontSize="24"
                   Margin="10"/>
        
        <ListBox Grid.Row="1" 
                 x:Name="ImageListBox"
                 Margin="10">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal" Margin="5">
                        <Image Source="{Binding FilePath}" 
                               Width="150" 
                               Height="150"
                               Margin="0,0,10,0"/>
                        <StackPanel>
                            <TextBlock Text="{Binding FileName}" FontWeight="Bold"/>
                            <TextBlock Text="{Binding Prompt}" TextWrapping="Wrap" Width="400"/>
                            <TextBlock Text="{Binding StartTime, StringFormat='Generated: {0:g}'}"/>
                        </StackPanel>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</Window>
```

### Enhancement 7.2: Add Quick Action Buttons

**ACTION:** Add toolbar with quick actions

```xml
<ToolBar>
    <Button Content="üé® Quick Image" Click="QuickImage_Click"/>
    <Separator/>
    <Button Content="üìÑ Quick Doc" Click="QuickDoc_Click"/>
    <Separator/>
    <Button Content="üéµ DJ Setlist" Click="QuickSetlist_Click"/>
</ToolBar>
```

---

## TROUBLESHOOTING GUIDE

### Common Issues & Solutions

**Issue: "CandyBotImageGenerator not found"**
- Solution: Build solution first (`Ctrl+Shift+B`)
- Verify file exists: `Services/CandyBotImageGenerator.cs`

**Issue: "Invalid API key"**
- Solution: Get API key from https://platform.openai.com/api-keys
- Configure via API Config window
- API key format: starts with "sk-"

**Issue: "Document created but won't open"**
- Solution: Install appropriate viewer (Office, PDF reader)
- Check file path in error message
- Try opening folder instead of file

**Issue: "Text file created instead of .docx"**
- Expected: This is normal without DocumentFormat.OpenXml package
- Solution: Install package for full functionality:
  ```
  Install-Package DocumentFormat.OpenXml
  ```

**Issue: "Voice not playing"**
- Solution: Check `_candySound` is initialized
- Verify voice mode enabled in settings
- Check voice files exist in `/Voices/` folder

---

## QUICK REFERENCE

### Generate Image
```csharp
var result = await _candyImageGen.GenerateImageAsync("prompt");
```

### Create Document
```csharp
var result = await _candyDocGen.CreateTextFileAsync("content");
```

### DJ Setlist
```csharp
await _candyDocGen.CreateDJSetlistAsync(dj, venue, date, tracks);
```

### Open Generated File
```csharp
_candyDocGen.OpenDocument(result.FilePath);
```

---

## COMPLETION CHECKLIST

- [ ] Phase 1: Services added to MainWindow ‚úì
- [ ] Phase 2: Test methods created ‚úì
- [ ] Phase 3: Test menu items added ‚úì
- [ ] Phase 4: API configuration window (optional) ‚úì
- [ ] Phase 5: Integration with bookings ‚úì
- [ ] Phase 6: All tests passing ‚úì
- [ ] Phase 7: Enhancements added (optional) ‚úì

---

## SUCCESS CRITERIA

**When complete, you should be able to:**
1. ‚úÖ Click "Run All Tests" and see success
2. ‚úÖ Generate documents without API key
3. ‚úÖ Generate images with API key
4. ‚úÖ Export booking data to documents
5. ‚úÖ Generate promotional materials
6. ‚úÖ Hear Candy's voice during operations

---

## NEXT STEPS AFTER INTEGRATION

1. **Configure API Key:**
   - Get from: https://platform.openai.com/api-keys
   - Store securely in app settings

2. **Install Optional Packages:**
   ```
   Install-Package DocumentFormat.OpenXml  # Word, PowerPoint
   Install-Package itext7                  # PDF
   Install-Package ClosedXML               # Excel
   ```

3. **Create Custom Workflows:**
   - Auto-generate materials on booking save
   - Batch generate images for events
   - Export reports to PDF

4. **Add UI Polish:**
   - Progress indicators for long operations
   - Image preview before saving
   - Document templates

---

**Document Version:** 1.0  
**Created:** November 16, 2024  
**Purpose:** VS2022 Copilot Execution - Image & Document Generation  
**Status:** Ready to Execute

üé®üìÑ **Execute and enjoy image & document generation!** ‚ú®
