# VS2022 Copilot: Execute Candy-Bot Upgrade

## MISSION OBJECTIVE
Integrate Candy-Bot voice system and file manager into the DJ Booking System. All required service files are already created. This document provides step-by-step integration instructions for Visual Studio 2022 Copilot.

---

## PHASE 1: VERIFY EXISTING FILES

### Files That Should Already Exist
‚úÖ `Services/CandyBotVoiceMapper.cs` - Voice line database
‚úÖ `Services/CandyBotSoundManager.cs` - Voice playback (UPDATED)
‚úÖ `Services/CandyBotFileManager.cs` - File operations
‚úÖ `Services/CandyBotVerificationUtility.cs` - Testing utility
‚úÖ `Voices/001.mp3` through `Voices/100.mp3` - Voice files

**ACTION:** Verify these files exist before proceeding.

---

## PHASE 2: MAINWINDOW INTEGRATION

### Task 2.1: Add Candy-Bot Services to MainWindow

**FILE:** `MainWindow.xaml.cs`

**ACTION:** Add these private fields at the top of the MainWindow class:

```csharp
// Candy-Bot Services
private CandyBotSoundManager _candySound;
private CandyBotFileManager _candyFiles;
```

### Task 2.2: Initialize Services in Constructor

**FILE:** `MainWindow.xaml.cs`

**ACTION:** Add this code in the MainWindow constructor, after `InitializeComponent();`:

```csharp
// Initialize Candy-Bot
_candySound = new CandyBotSoundManager();
_candySound.SetVoiceMode(true);
_candySound.SetSoundsEnabled(true);

_candyFiles = new CandyBotFileManager();

// Welcome greeting
_candySound.PlayGreeting();
```

### Task 2.3: Add Verification Method

**FILE:** `MainWindow.xaml.cs`

**ACTION:** Add this method to MainWindow class:

```csharp
/// <summary>
/// Verify Candy-Bot installation and functionality
/// </summary>
private async void VerifyCandyBot()
{
    await CandyBotVerificationUtility.ShowVerificationDialogAsync();
}
```

**OPTIONAL:** Call `VerifyCandyBot();` in constructor to test on startup.

---

## PHASE 3: ADD VOICE FEEDBACK TO EXISTING METHODS

### Task 3.1: Add Voice to Booking Confirmation

**FILE:** Find the method that saves bookings (likely in `MainWindow.xaml.cs` or booking-related window)

**ACTION:** Wrap existing save code with voice feedback:

```csharp
private async void SaveBooking() // or similar method name
{
    try
    {
        // EXISTING BOOKING SAVE CODE STAYS HERE
        // ... your booking save logic ...
        
        // ADD THIS - Success voice
        await _candySound.PlayVoiceLine("038"); // "Booking confirmed!"
        
        // Or use:
        // _candySound.PlayBookingResponse();
    }
    catch (Exception ex)
    {
        // EXISTING ERROR HANDLING
        
        // ADD THIS - Error voice
        await _candySound.PlayVoiceLine("056"); // "Oops! Something went wrong..."
        
        // Or use:
        // _candySound.PlayErrorResponse();
    }
}
```

### Task 3.2: Add Voice to Error Handlers

**ACTION:** Find any existing `catch` blocks and add:

```csharp
catch (Exception ex)
{
    // Existing error handling...
    
    // ADD THIS:
    await _candySound.PlayVoiceLine("056"); // Error voice
}
```

### Task 3.3: Add Voice to Success Operations

**ACTION:** Find any successful operations (saves, updates, deletions) and add:

```csharp
// After successful operation:
await _candySound.PlayVoiceLine("042"); // "Perfect! You're all set!"
// OR
_candySound.PlayPositiveFeedback();
```

---

## PHASE 4: CREATE CANDY-BOT SETTINGS PANEL (OPTIONAL)

### Task 4.1: Add Voice Settings to Settings Window

**FILE:** `SettingsView.xaml` or `UserSettingsWindow.xaml`

**ACTION:** Add these UI elements:

```xml
<!-- Candy-Bot Voice Settings -->
<GroupBox Header="üç¨ Candy-Bot Voice" Margin="0,10,0,0">
    <StackPanel>
        <CheckBox x:Name="EnableVoiceCheckBox" 
                  Content="Enable Candy Voice" 
                  IsChecked="True"
                  Checked="EnableVoice_Changed"
                  Unchecked="EnableVoice_Changed"/>
        
        <CheckBox x:Name="EnableSoundsCheckBox" 
                  Content="Enable Sound Effects" 
                  IsChecked="True"
                  Checked="EnableSounds_Changed"
                  Unchecked="EnableSounds_Changed"
                  Margin="0,5,0,0"/>
        
        <TextBlock Text="Personality Mode:" Margin="0,10,0,5"/>
        <ComboBox x:Name="PersonalityComboBox" 
                  SelectionChanged="Personality_Changed">
            <ComboBoxItem Content="Normal" IsSelected="True" Tag="Normal"/>
            <ComboBoxItem Content="Shy" Tag="Shy"/>
            <ComboBoxItem Content="Funny" Tag="Funny"/>
            <ComboBoxItem Content="Sarcastic" Tag="ShitStirring"/>
            <ComboBoxItem Content="Professional" Tag="Professional"/>
            <ComboBoxItem Content="Raunchy (18+)" Tag="Raunchy"/>
        </ComboBox>
        
        <Button Content="üé§ Test Voice" 
                Click="TestVoice_Click" 
                Margin="0,10,0,0"/>
    </StackPanel>
</GroupBox>
```

### Task 4.2: Add Code-Behind for Settings

**FILE:** `SettingsView.xaml.cs` or corresponding code-behind

**ACTION:** Add these event handlers:

```csharp
private void EnableVoice_Changed(object sender, RoutedEventArgs e)
{
    if (_candySound != null)
    {
        _candySound.SetVoiceMode(EnableVoiceCheckBox.IsChecked ?? true);
    }
}

private void EnableSounds_Changed(object sender, RoutedEventArgs e)
{
    if (_candySound != null)
    {
        _candySound.SetSoundsEnabled(EnableSoundsCheckBox.IsChecked ?? true);
    }
}

private void Personality_Changed(object sender, SelectionChangedEventArgs e)
{
    if (_candySound != null && PersonalityComboBox.SelectedItem is ComboBoxItem item)
    {
        var mode = item.Tag.ToString();
        var personality = Enum.Parse<CandyBotPersonalityMode>(mode);
        _candySound.SetPersonality(personality);
    }
}

private async void TestVoice_Click(object sender, RoutedEventArgs e)
{
    if (_candySound != null)
    {
        _candySound.PlayGreeting();
    }
}
```

---

## PHASE 5: CREATE FILE MANAGER UI (OPTIONAL)

### Task 5.1: Create File Browser Window

**ACTION:** Create new Window called `CandyBotFileBrowserWindow.xaml`

**XAML:**
```xml
<Window x:Class="DJBookingSystem.CandyBotFileBrowserWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="üç¨ Candy-Bot File Manager"
        Height="600" Width="900"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <TextBlock Grid.Row="0" 
                   Text="üç¨ Candy-Bot File Manager" 
                   FontSize="24" 
                   FontWeight="Bold"
                   Margin="10"/>
        
        <!-- Search Controls -->
        <StackPanel Grid.Row="1" Margin="10" Orientation="Horizontal">
            <TextBox x:Name="SearchTextBox" 
                     Width="300" 
                     Height="30"
                     VerticalContentAlignment="Center"
                     Margin="0,0,10,0"/>
            
            <ComboBox x:Name="FileTypeComboBox" 
                      Width="150" 
                      Height="30"
                      Margin="0,0,10,0">
                <ComboBoxItem Content="All Files" IsSelected="True"/>
                <ComboBoxItem Content="Music (.mp3, .wav)" Tag="music"/>
                <ComboBoxItem Content="Documents (.pdf, .docx)" Tag="docs"/>
                <ComboBoxItem Content="Images (.jpg, .png)" Tag="images"/>
            </ComboBox>
            
            <Button Content="üîç Search" 
                    Click="Search_Click" 
                    Width="100" 
                    Height="30"
                    Margin="0,0,10,0"/>
            
            <Button Content="üìÅ Approve Folder" 
                    Click="ApproveFolder_Click" 
                    Width="120" 
                    Height="30"/>
        </StackPanel>
        
        <!-- Results Grid -->
        <DataGrid Grid.Row="2" 
                  x:Name="ResultsDataGrid"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  Margin="10">
            <DataGrid.Columns>
                <DataGridTextColumn Header="File Name" Binding="{Binding FileName}" Width="*"/>
                <DataGridTextColumn Header="Extension" Binding="{Binding Extension}" Width="100"/>
                <DataGridTextColumn Header="Size (MB)" Binding="{Binding SizeMB, StringFormat={}{0:F2}}" Width="100"/>
                <DataGridTextColumn Header="Modified" Binding="{Binding LastModified, StringFormat={}{0:yyyy-MM-dd}}" Width="120"/>
            </DataGrid.Columns>
        </DataGrid>
        
        <!-- Status Bar -->
        <StackPanel Grid.Row="3" 
                    Orientation="Horizontal" 
                    Background="#2D2D30" 
                    Height="30">
            <TextBlock x:Name="StatusTextBlock" 
                       Text="Ready" 
                       Foreground="White"
                       VerticalAlignment="Center"
                       Margin="10,0"/>
        </StackPanel>
    </Grid>
</Window>
```

### Task 5.2: Add Code-Behind for File Browser

**FILE:** `CandyBotFileBrowserWindow.xaml.cs`

**CODE:**
```csharp
using System;
using System.Collections.Generic;
using System.Windows;
using System.Windows.Controls;
using DJBookingSystem.Services;
using System.Windows.Forms; // For FolderBrowserDialog

namespace DJBookingSystem
{
    public partial class CandyBotFileBrowserWindow : Window
    {
        private CandyBotFileManager _fileManager;
        private CandyBotSoundManager _soundManager;

        public CandyBotFileBrowserWindow()
        {
            InitializeComponent();
            
            _fileManager = new CandyBotFileManager();
            _soundManager = new CandyBotSoundManager();
            _soundManager.SetVoiceMode(true);
            
            _soundManager.PlayGreeting();
        }

        private void ApproveFolder_Click(object sender, RoutedEventArgs e)
        {
            var dialog = new FolderBrowserDialog();
            
            if (dialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)
            {
                _fileManager.AddApprovedFolder(dialog.SelectedPath);
                StatusTextBlock.Text = $"Approved: {dialog.SelectedPath}";
                _soundManager.PlayPositiveFeedback();
            }
        }

        private async void Search_Click(object sender, RoutedEventArgs e)
        {
            try
            {
                StatusTextBlock.Text = "Searching...";
                await _soundManager.PlayVoiceLine("018"); // "Looking for something specific?"
                
                List<FileSearchResult> results;
                
                var selectedType = (FileTypeComboBox.SelectedItem as ComboBoxItem)?.Tag?.ToString();
                
                if (selectedType == "music")
                {
                    results = await _fileManager.FindMusicFilesAsync();
                }
                else if (!string.IsNullOrEmpty(SearchTextBox.Text))
                {
                    results = await _fileManager.SearchFilesAsync(
                        searchPattern: $"*{SearchTextBox.Text}*"
                    );
                }
                else
                {
                    results = await _fileManager.SearchFilesAsync();
                }
                
                ResultsDataGrid.ItemsSource = results;
                StatusTextBlock.Text = $"Found {results.Count} files";
                
                if (results.Count > 0)
                {
                    await _soundManager.PlayVoiceLine("042"); // "Perfect!"
                }
                else
                {
                    await _soundManager.PlayVoiceLine("058"); // "Couldn't find that"
                }
            }
            catch (Exception ex)
            {
                StatusTextBlock.Text = $"Error: {ex.Message}";
                await _soundManager.PlayVoiceLine("056"); // Error voice
            }
        }
    }
}
```

---

## PHASE 6: ADD MENU ITEMS TO OPEN NEW WINDOWS

### Task 6.1: Add Menu Item for File Browser

**FILE:** `MainWindow.xaml`

**ACTION:** Add menu item to open Candy-Bot File Browser:

```xml
<MenuItem Header="üç¨ Candy-Bot File Manager" Click="OpenCandyBotFiles_Click"/>
```

### Task 6.2: Add Click Handler

**FILE:** `MainWindow.xaml.cs`

**ACTION:** Add this method:

```csharp
private void OpenCandyBotFiles_Click(object sender, RoutedEventArgs e)
{
    var window = new CandyBotFileBrowserWindow();
    window.Show();
}
```

---

## PHASE 7: VOICE LINE REFERENCE

### Quick Voice Line Lookup

Use these in your code:

```csharp
// Greetings (001-015)
await _candySound.PlayVoiceLine("001"); // "Hi there! I'm Candy-Bot..."
_candySound.PlayGreeting(); // Random greeting

// Help (016-030)
await _candySound.PlayVoiceLine("018"); // "Looking for something specific?"
_candySound.PlayHelpResponse(); // Random help

// Booking (031-040)
await _candySound.PlayVoiceLine("038"); // "Booking confirmed!"
_candySound.PlayBookingResponse(); // Random booking

// Success (041-055)
await _candySound.PlayVoiceLine("042"); // "Perfect! You're all set!"
await _candySound.PlayVoiceLine("048"); // "Boom! Task completed!"
_candySound.PlayPositiveFeedback(); // Random success

// Error (056-065)
await _candySound.PlayVoiceLine("056"); // "Oops! Something went wrong..."
await _candySound.PlayVoiceLine("058"); // "Hmm, I couldn't find that"
_candySound.PlayErrorResponse(); // Random error
```

---

## PHASE 8: TESTING CHECKLIST

### Step-by-Step Testing

1. **Build Solution**
   - Press `Ctrl+Shift+B`
   - Verify no errors

2. **Test Voice System**
   - Run application (`F5`)
   - Should hear greeting voice on startup
   - If you added verification call, dialog should appear

3. **Test Manual Verification**
   - Add button that calls: `await CandyBotVerificationUtility.ShowVerificationDialogAsync();`
   - Click button
   - Should see "All tests PASSED" dialog

4. **Test File Manager** (if implemented)
   - Open File Manager window
   - Click "Approve Folder"
   - Select a folder
   - Click "Search"
   - Should see files listed with voice feedback

---

## COPILOT USAGE GUIDE

### How to Use This Document with Copilot

1. **Open this file in VS2022**
2. **Copilot will understand the context**
3. **Type comments describing what you want**
4. **Copilot will suggest code based on this document**

### Example Copilot Prompts

```csharp
// Add Candy voice to this save method using voice line 038 for success

// Create a search method that finds MP3 files with voice feedback

// Add error voice to all catch blocks in this class

// Create a button handler that plays a random greeting

// Implement the organize downloads feature with voice progress updates
```

---

## SUMMARY

**Required Files** (already created):
- ‚úÖ CandyBotVoiceMapper.cs
- ‚úÖ CandyBotSoundManager.cs (updated)
- ‚úÖ CandyBotFileManager.cs
- ‚úÖ CandyBotVerificationUtility.cs
- ‚úÖ 100 voice MP3 files

**Required Integrations** (to do):
- Phase 2: MainWindow integration (REQUIRED)
- Phase 3: Voice feedback in existing methods (RECOMMENDED)
- Phase 4: Settings panel (OPTIONAL)
- Phase 5: File browser UI (OPTIONAL)
- Phase 6: Menu items (OPTIONAL)

**Minimum Implementation:**
Just do **Phase 2** to get Candy-Bot working!

**Full Implementation:**
Complete all phases for full voice and file management features.

---

## QUICK START

**Fastest way to test:**

1. Open `MainWindow.xaml.cs`
2. Add after `InitializeComponent();`:
   ```csharp
   var sound = new CandyBotSoundManager();
   sound.SetVoiceMode(true);
   sound.SetSoundsEnabled(true);
   sound.PlayGreeting();
   await CandyBotVerificationUtility.ShowVerificationDialogAsync();
   ```
3. Press `F5` to run
4. Hear Candy's voice and see verification results!

---

**Document Version:** 1.0  
**Created:** November 16, 2024  
**Purpose:** VS2022 Copilot Integration Instructions  
**Status:** Ready to Execute

üç¨ **Execute and enjoy Candy-Bot!** ‚ú®
# PHASE 9: IMAGE GENERATION INTEGRATION

## Overview
Candy-Bot can now generate AI images using OpenAI DALL-E or other providers!

## Files Added
‚úÖ `Services/CandyBotImageGenerator.cs` - AI image generation

---

## Task 9.1: Add Image Generator to MainWindow

**FILE:** `MainWindow.xaml.cs`

**ACTION:** Add private field:

```csharp
// Candy-Bot Image Generator
private CandyBotImageGenerator _candyImageGen;
```

**ACTION:** Initialize in constructor (after Candy-Bot services):

```csharp
// Initialize Image Generator
// IMPORTANT: Add your OpenAI API key here
_candyImageGen = new CandyBotImageGenerator(
    apiKey: "your-openai-api-key-here", // Get from https://platform.openai.com/api-keys
    provider: CandyBotImageGenerator.ImageProvider.OpenAI_DALLE3,
    soundManager: _candySound
);
```

---

## Task 9.2: Create Image Generation Window (OPTIONAL)

**ACTION:** Create new Window: `CandyBotImageGeneratorWindow.xaml`

**XAML:**
```xml
<Window x:Class="DJBookingSystem.CandyBotImageGeneratorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="üé® Candy-Bot Image Generator"
        Height="700" Width="1000"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <TextBlock Grid.Row="0" 
                   Text="üé® AI Image Generator" 
                   FontSize="24" 
                   FontWeight="Bold"
                   Margin="10"/>
        
        <!-- Controls -->
        <StackPanel Grid.Row="1" Margin="10">
            <TextBlock Text="Describe the image you want to create:" Margin="0,0,0,5"/>
            <TextBox x:Name="PromptTextBox" 
                     Height="80" 
                     TextWrapping="Wrap"
                     AcceptsReturn="True"
                     Margin="0,0,0,10"/>
            
            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <TextBlock Text="Size:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <ComboBox x:Name="SizeComboBox" Width="200" SelectedIndex="0">
                    <ComboBoxItem Content="Square (1024x1024)" Tag="Square_1024"/>
                    <ComboBoxItem Content="Portrait (1024x1792)" Tag="Portrait_1024x1792"/>
                    <ComboBoxItem Content="Landscape (1792x1024)" Tag="Landscape_1792x1024"/>
                </ComboBox>
                
                <TextBlock Text="Quality:" VerticalAlignment="Center" Margin="20,0,10,0"/>
                <ComboBox x:Name="QualityComboBox" Width="150" SelectedIndex="0">
                    <ComboBoxItem Content="Standard" Tag="Standard"/>
                    <ComboBoxItem Content="HD (slower)" Tag="HD"/>
                </ComboBox>
            </StackPanel>
            
            <StackPanel Orientation="Horizontal">
                <Button Content="üé® Generate Image" 
                        Click="GenerateImage_Click" 
                        Width="150" 
                        Height="35"
                        Margin="0,0,10,0"/>
                
                <Button Content="üéµ DJ Preset" 
                        Click="DJPreset_Click" 
                        Width="120" 
                        Height="35"
                        Margin="0,0,10,0"/>
            </StackPanel>
        </StackPanel>
        
        <!-- Generated Image Display -->
        <Border Grid.Row="2" 
                BorderBrush="Gray" 
                BorderThickness="1" 
                Margin="10">
            <Image x:Name="GeneratedImage" 
                   Stretch="Uniform"/>
        </Border>
        
        <!-- Status Bar -->
        <StackPanel Grid.Row="3" 
                    Orientation="Horizontal" 
                    Background="#2D2D30" 
                    Height="30">
            <TextBlock x:Name="StatusTextBlock" 
                       Text="Ready to generate images" 
                       Foreground="White"
                       VerticalAlignment="Center"
                       Margin="10,0"/>
        </StackPanel>
    </Grid>
</Window>
```

**CODE-BEHIND:** `CandyBotImageGeneratorWindow.xaml.cs`

```csharp
using System;
using System.Windows;
using System.Windows.Media.Imaging;
using DJBookingSystem.Services;

namespace DJBookingSystem
{
    public partial class CandyBotImageGeneratorWindow : Window
    {
        private CandyBotImageGenerator _imageGen;

        public CandyBotImageGeneratorWindow(CandyBotImageGenerator imageGenerator)
        {
            InitializeComponent();
            _imageGen = imageGenerator;
        }

        private async void GenerateImage_Click(object sender, RoutedEventArgs e)
        {
            if (string.IsNullOrWhiteSpace(PromptTextBox.Text))
            {
                MessageBox.Show("Please enter an image description!");
                return;
            }

            try
            {
                StatusTextBlock.Text = "Generating image... This may take 30-60 seconds...";
                GenerateImage.IsEnabled = false;

                // Get selected options
                var size = (ImageSize)Enum.Parse(typeof(ImageSize), 
                    ((ComboBoxItem)SizeComboBox.SelectedItem).Tag.ToString());
                var quality = (ImageQuality)Enum.Parse(typeof(ImageQuality), 
                    ((ComboBoxItem)QualityComboBox.SelectedItem).Tag.ToString());

                // Generate image
                var result = await _imageGen.GenerateImageAsync(
                    PromptTextBox.Text,
                    size: size,
                    quality: quality
                );

                if (result.Success)
                {
                    // Display image
                    var bitmap = new BitmapImage();
                    bitmap.BeginInit();
                    bitmap.UriSource = new Uri(result.LocalFilePath);
                    bitmap.CacheOption = BitmapCacheOption.OnLoad;
                    bitmap.EndInit();
                    GeneratedImage.Source = bitmap;

                    StatusTextBlock.Text = $"Image saved to: {result.LocalFilePath}";
                }
                else
                {
                    StatusTextBlock.Text = $"Error: {result.ErrorMessage}";
                    MessageBox.Show(result.ErrorMessage, "Generation Failed");
                }
            }
            catch (Exception ex)
            {
                StatusTextBlock.Text = $"Error: {ex.Message}";
                MessageBox.Show(ex.Message, "Error");
            }
            finally
            {
                GenerateImage.IsEnabled = true;
            }
        }

        private async void DJPreset_Click(object sender, RoutedEventArgs e)
        {
            var result = await _imageGen.GenerateDJImageAsync(
                DJImagePreset.NeonClubScene
            );

            if (result.Success)
            {
                var bitmap = new BitmapImage(new Uri(result.LocalFilePath));
                GeneratedImage.Source = bitmap;
                StatusTextBlock.Text = $"DJ preset image saved: {result.LocalFilePath}";
            }
        }
    }
}
```

---

## Task 9.3: Add Menu Item

**FILE:** `MainWindow.xaml`

**ACTION:** Add to menu:

```xml
<MenuItem Header="üé® Generate AI Image" Click="OpenImageGenerator_Click"/>
```

**FILE:** `MainWindow.xaml.cs`

**ACTION:** Add handler:

```csharp
private void OpenImageGenerator_Click(object sender, RoutedEventArgs e)
{
    var window = new CandyBotImageGeneratorWindow(_candyImageGen);
    window.Show();
}
```

---

## Quick Test - Image Generation

**Add to MainWindow for testing:**

```csharp
private async void TestImageGeneration()
{
    // Simple test
    var result = await _candyImageGen.GenerateImageAsync(
        "A cyberpunk DJ booth with neon green lights"
    );
    
    if (result.Success)
    {
        MessageBox.Show($"Image saved to: {result.LocalFilePath}");
    }
}
```

---

# PHASE 10: DOCUMENT GENERATION INTEGRATION

## Overview
Candy-Bot can now create Word docs, PDFs, PowerPoints, Excel files, and more!

## Files Added
‚úÖ `Services/CandyBotDocumentGenerator.cs` - Document creation

---

## Task 10.1: Add Document Generator to MainWindow

**FILE:** `MainWindow.xaml.cs`

**ACTION:** Add private field:

```csharp
// Candy-Bot Document Generator
private CandyBotDocumentGenerator _candyDocGen;
```

**ACTION:** Initialize in constructor:

```csharp
// Initialize Document Generator
_candyDocGen = new CandyBotDocumentGenerator(_candySound);
```

---

## Task 10.2: Create Document Generator Window (OPTIONAL)

**ACTION:** Create new Window: `CandyBotDocumentGeneratorWindow.xaml`

**XAML:**
```xml
<Window x:Class="DJBookingSystem.CandyBotDocumentGeneratorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="üìÑ Candy-Bot Document Generator"
        Height="600" Width="800"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <TextBlock Grid.Row="0" 
                   Text="üìÑ Document Generator" 
                   FontSize="24" 
                   FontWeight="Bold"
                   Margin="10"/>
        
        <TabControl Grid.Row="1" Grid.RowSpan="2" Margin="10">
            
            <!-- DJ Setlist Tab -->
            <TabItem Header="üéµ DJ Setlist">
                <StackPanel Margin="10">
                    <TextBlock Text="DJ Name:" Margin="0,0,0,5"/>
                    <TextBox x:Name="DJNameTextBox" Margin="0,0,0,10"/>
                    
                    <TextBlock Text="Venue:" Margin="0,0,0,5"/>
                    <TextBox x:Name="VenueTextBox" Margin="0,0,0,10"/>
                    
                    <TextBlock Text="Event Date:" Margin="0,0,0,5"/>
                    <DatePicker x:Name="EventDatePicker" Margin="0,0,0,10"/>
                    
                    <TextBlock Text="Tracks (one per line: Artist - Title - Duration):" Margin="0,0,0,5"/>
                    <TextBox x:Name="TracksTextBox" 
                             Height="200" 
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             Margin="0,0,0,10"/>
                    
                    <Button Content="üìÑ Generate Setlist" 
                            Click="GenerateSetlist_Click" 
                            Width="150" 
                            Height="35"/>
                </StackPanel>
            </TabItem>
            
            <!-- Booking Contract Tab -->
            <TabItem Header="üìù Booking Contract">
                <StackPanel Margin="10">
                    <TextBlock Text="DJ Name:" Margin="0,0,0,5"/>
                    <TextBox x:Name="ContractDJTextBox" Margin="0,0,0,10"/>
                    
                    <TextBlock Text="Venue:" Margin="0,0,0,5"/>
                    <TextBox x:Name="ContractVenueTextBox" Margin="0,0,0,10"/>
                    
                    <TextBlock Text="Event Date:" Margin="0,0,0,5"/>
                    <DatePicker x:Name="ContractDatePicker" Margin="0,0,0,10"/>
                    
                    <TextBlock Text="Fee ($):" Margin="0,0,0,5"/>
                    <TextBox x:Name="FeeTextBox" Margin="0,0,0,10"/>
                    
                    <TextBlock Text="Additional Terms:" Margin="0,0,0,5"/>
                    <TextBox x:Name="TermsTextBox" 
                             Height="150" 
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             Margin="0,0,0,10"/>
                    
                    <Button Content="üìù Generate Contract" 
                            Click="GenerateContract_Click" 
                            Width="150" 
                            Height="35"/>
                </StackPanel>
            </TabItem>
            
            <!-- Quick Document Tab -->
            <TabItem Header="üìÑ Quick Document">
                <StackPanel Margin="10">
                    <TextBlock Text="Document Title:" Margin="0,0,0,5"/>
                    <TextBox x:Name="DocTitleTextBox" Margin="0,0,0,10"/>
                    
                    <TextBlock Text="Content:" Margin="0,0,0,5"/>
                    <TextBox x:Name="DocContentTextBox" 
                             Height="250" 
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             Margin="0,0,0,10"/>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="üìÑ Word" Click="GenerateWord_Click" Width="100" Margin="0,0,5,0"/>
                        <Button Content="üìï PDF" Click="GeneratePDF_Click" Width="100" Margin="0,0,5,0"/>
                        <Button Content="üìù Text" Click="GenerateText_Click" Width="100" Margin="0,0,5,0"/>
                        <Button Content="üìã Markdown" Click="GenerateMarkdown_Click" Width="100"/>
                    </StackPanel>
                </StackPanel>
            </TabItem>
            
        </TabControl>
    </Grid>
</Window>
```

**CODE-BEHIND:** `CandyBotDocumentGeneratorWindow.xaml.cs`

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using DJBookingSystem.Services;

namespace DJBookingSystem
{
    public partial class CandyBotDocumentGeneratorWindow : Window
    {
        private CandyBotDocumentGenerator _docGen;

        public CandyBotDocumentGeneratorWindow(CandyBotDocumentGenerator docGenerator)
        {
            InitializeComponent();
            _docGen = docGenerator;
            EventDatePicker.SelectedDate = DateTime.Now;
            ContractDatePicker.SelectedDate = DateTime.Now;
        }

        private async void GenerateSetlist_Click(object sender, RoutedEventArgs e)
        {
            try
            {
                var tracks = ParseTracks(TracksTextBox.Text);
                
                var result = await _docGen.CreateDJSetlistAsync(
                    DJNameTextBox.Text,
                    VenueTextBox.Text,
                    EventDatePicker.SelectedDate ?? DateTime.Now,
                    tracks
                );

                if (result.Success)
                {
                    MessageBox.Show($"Setlist created!\n{result.FilePath}", "Success");
                    _docGen.OpenDocument(result.FilePath);
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message, "Error");
            }
        }

        private async void GenerateContract_Click(object sender, RoutedEventArgs e)
        {
            try
            {
                var result = await _docGen.CreateBookingContractAsync(
                    ContractDJTextBox.Text,
                    ContractVenueTextBox.Text,
                    ContractDatePicker.SelectedDate ?? DateTime.Now,
                    decimal.Parse(FeeTextBox.Text),
                    TermsTextBox.Text
                );

                if (result.Success)
                {
                    MessageBox.Show($"Contract created!\n{result.FilePath}", "Success");
                    _docGen.OpenDocument(result.FilePath);
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message, "Error");
            }
        }

        private async void GenerateWord_Click(object sender, RoutedEventArgs e)
        {
            var result = await _docGen.CreateWordDocumentAsync(
                DocTitleTextBox.Text,
                DocContentTextBox.Text
            );
            ShowResult(result);
        }

        private async void GeneratePDF_Click(object sender, RoutedEventArgs e)
        {
            var result = await _docGen.CreatePDFDocumentAsync(
                DocTitleTextBox.Text,
                DocContentTextBox.Text
            );
            ShowResult(result);
        }

        private async void GenerateText_Click(object sender, RoutedEventArgs e)
        {
            var result = await _docGen.CreateTextFileAsync(
                $"{DocTitleTextBox.Text}\n\n{DocContentTextBox.Text}"
            );
            ShowResult(result);
        }

        private async void GenerateMarkdown_Click(object sender, RoutedEventArgs e)
        {
            var result = await _docGen.CreateMarkdownFileAsync(
                DocTitleTextBox.Text,
                DocContentTextBox.Text
            );
            ShowResult(result);
        }

        private void ShowResult(DocumentResult result)
        {
            if (result.Success)
            {
                MessageBox.Show($"Document created!\n{result.FilePath}", "Success");
                _docGen.OpenDocument(result.FilePath);
            }
            else
            {
                MessageBox.Show(result.ErrorMessage, "Error");
            }
        }

        private List<Track> ParseTracks(string trackText)
        {
            var tracks = new List<Track>();
            var lines = trackText.Split('\n');
            
            foreach (var line in lines)
            {
                if (string.IsNullOrWhiteSpace(line)) continue;
                
                var parts = line.Split('-');
                if (parts.Length >= 3)
                {
                    tracks.Add(new Track
                    {
                        Artist = parts[0].Trim(),
                        Title = parts[1].Trim(),
                        Duration = parts[2].Trim()
                    });
                }
            }
            
            return tracks;
        }
    }
}
```

---

## Task 10.3: Add Menu Item

**FILE:** `MainWindow.xaml`

**ACTION:** Add to menu:

```xml
<MenuItem Header="üìÑ Generate Documents" Click="OpenDocumentGenerator_Click"/>
```

**FILE:** `MainWindow.xaml.cs`

**ACTION:** Add handler:

```csharp
private void OpenDocumentGenerator_Click(object sender, RoutedEventArgs e)
{
    var window = new CandyBotDocumentGeneratorWindow(_candyDocGen);
    window.Show();
}
```

---

## Quick Test - Document Generation

**Add to MainWindow for testing:**

```csharp
private async void TestDocumentGeneration()
{
    // Create a simple text file
    var result = await _candyDocGen.CreateTextFileAsync(
        "Hello from Candy-Bot!\n\nThis is a test document."
    );
    
    if (result.Success)
    {
        MessageBox.Show($"Document saved to: {result.FilePath}");
        _candyDocGen.OpenDocument(result.FilePath);
    }
}
```

---

## IMPORTANT NOTES

### Image Generation Requirements
- **Requires API Key** from OpenAI: https://platform.openai.com/api-keys
- **Costs money** - DALL-E 3 charges per image generated
- Alternative: Can implement Stable Diffusion or local generation

### Document Generation Note
- Basic implementation uses **text files** as placeholders
- For full functionality, install these NuGet packages:
  ```
  Install-Package DocumentFormat.OpenXml   (Word, PowerPoint)
  Install-Package itext7                   (PDF)
  Install-Package ClosedXML                (Excel)
  ```
- After installing packages, update the placeholder methods with real implementations

---

## COPILOT PROMPTS FOR NEW FEATURES

### Image Generation
```
"Create a button that generates a DJ booth image"
"Generate event poster using AI image generator"
"Add image generation to booking confirmation"
```

### Document Generation
```
"Create DJ setlist document from booking data"
"Generate booking contract for this venue"
"Export booking calendar as PDF"
```

---

**Document Updated:** November 16, 2024  
**New Phases Added:** Phase 9 (Images), Phase 10 (Documents)  
**Status:** Ready for integration!
