# ?? Candy-Bot Phase 2 - Quick Reference Guide

## Available Services in MainWindow

After Phase 2 integration, MainWindow has access to two powerful services:

### 1. CandyBotSoundManager (_candySound)
Handles all voice and sound effects for Candy-Bot

### 2. CandyBotFileManager (_candyFiles)
Handles file search, organization, and management

---

## CandyBotSoundManager Quick Reference

### Basic Voice Commands

```csharp
// Play welcome greeting
_candySound?.PlayGreeting();

// Play positive feedback
_candySound?.PlayPositiveFeedback();

// Play error response
_candySound?.PlayErrorResponse();

// Play booking response
_candySound?.PlayBookingResponse();
```

### Play Specific Voice Lines

```csharp
// Play by voice line number (001-100)
await _candySound?.PlayVoiceLine("038"); // "Booking confirmed!"
await _candySound?.PlayVoiceLine("056"); // "Oops! Something went wrong..."
await _candySound?.PlayVoiceLine("042"); // "Perfect! You're all set!"
await _candySound?.PlayVoiceLine("018"); // "Looking for something specific?"
```

### Voice Line Reference (Common Ones)

| Line | Content | Use Case |
|------|---------|----------|
| 001  | "Hey there! I'm Candy!" | Greeting |
| 018  | "Looking for something specific?" | Search initiation |
| 038  | "Booking confirmed!" | Booking success |
| 042  | "Perfect! You're all set!" | Success |
| 056  | "Oops! Something went wrong..." | Error |
| 058  | "Couldn't find that" | Search no results |

### Control Settings

```csharp
// Enable/disable voice mode
_candySound?.SetVoiceMode(true);  // Enable voice
_candySound?.SetVoiceMode(false); // Disable voice

// Enable/disable sound effects
_candySound?.SetSoundsEnabled(true);  // Enable sounds
_candySound?.SetSoundsEnabled(false); // Disable sounds

// Change personality
_candySound?.SetPersonality(CandyBotPersonalityMode.Normal);
_candySound?.SetPersonality(CandyBotPersonalityMode.Funny);
_candySound?.SetPersonality(CandyBotPersonalityMode.Professional);
```

### Personality Modes Available

```csharp
public enum CandyBotPersonalityMode
{
    Normal,          // ?? Sweet & Balanced
    Shy,             // ?? Timid & Gentle
    Funny,           // ?? Jokes & Puns
    ShitStirring,    // ?? Sarcastic
    Professional,    // ?? Formal
    Raunchy          // ?? Flirty (18+, requires age verification)
}
```

---

## CandyBotFileManager Quick Reference

### Search Files

```csharp
// Search all approved folders
var allFiles = await _candyFiles?.SearchFilesAsync();

// Search for specific file type
var musicFiles = await _candyFiles?.SearchFilesAsync(
    searchPattern: "*.*",
    fileExtension: ".mp3");

// Search specific folder
var folderFiles = await _candyFiles?.SearchFilesAsync(
    searchPattern: "*.*",
    fileExtension: null,
    folderPath: @"C:\Music",
    includeSubfolders: true);
```

### Find Specific File Types

```csharp
// Find all music files
var musicFiles = await _candyFiles?.FindMusicFilesAsync();

// Results include: .mp3, .wav, .flac, .m4a
```

### Manage Approved Folders

```csharp
// Add approved folder
_candyFiles?.AddApprovedFolder(@"C:\MyDocuments");

// Remove approved folder
_candyFiles?.RemoveApprovedFolder(@"C:\MyDocuments");

// Check if folder is approved
bool isApproved = _candyFiles?.IsFolderApproved(@"C:\MyDocuments") ?? false;

// Get all approved folders
var approvedFolders = _candyFiles?.GetApprovedFolders();
```

### File Operations

```csharp
// Copy file
bool copied = _candyFiles?.CopyFile(
    sourceFilePath: @"C:\source\file.mp3",
    destinationFilePath: @"C:\dest\file.mp3") ?? false;

// Move file
bool moved = _candyFiles?.MoveFile(
    sourceFilePath: @"C:\source\file.mp3",
    destinationFilePath: @"C:\dest\file.mp3") ?? false;

// Delete file
bool deleted = _candyFiles?.DeleteFile(
    filePath: @"C:\file.mp3") ?? false;
```

### Organize Files

```csharp
// Auto-organize files by category
int organized = await _candyFiles?.OrganizeFilesByCategoryAsync(
    sourceFolderPath: @"C:\Downloads") ?? 0;

// Creates folders: Music, Documents, Images, Videos
// Moves files to appropriate category folders
```

### File Search Results

```csharp
public class FileSearchResult
{
    public string FilePath { get; set; }      // Full path
    public string FileName { get; set; }      // File name only
    public string Extension { get; set; }     // .mp3, .pdf, etc.
    public double SizeMB { get; set; }        // Size in megabytes
    public DateTime LastModified { get; set; } // Last modified date
}
```

---

## Example: Add Voice to Booking Save

```csharp
private async void SaveBooking_Click(object sender, RoutedEventArgs e)
{
    try
    {
        // Your existing booking save code
        var booking = CreateBookingFromForm();
        await _cosmosDbService.SaveBookingAsync(booking);
        
        // ? Add Candy-Bot voice feedback
        await _candySound?.PlayVoiceLine("038"); // "Booking confirmed!"
        
        MessageBox.Show("Booking saved successfully!");
    }
    catch (Exception ex)
    {
        // ? Add Candy-Bot error voice
        await _candySound?.PlayVoiceLine("056"); // "Oops! Something went wrong..."
        
        MessageBox.Show($"Error: {ex.Message}");
    }
}
```

---

## Example: File Search with Voice Feedback

```csharp
private async void SearchFiles_Click(object sender, RoutedEventArgs e)
{
    try
    {
        // Play search start voice
        await _candySound?.PlayVoiceLine("018"); // "Looking for something specific?"
        
        // Perform search
        var results = await _candyFiles?.FindMusicFilesAsync();
        
        if (results != null && results.Count > 0)
        {
            // Success voice
            await _candySound?.PlayVoiceLine("042"); // "Perfect!"
            
            // Display results
            FileResultsGrid.ItemsSource = results;
            StatusText.Text = $"Found {results.Count} music files";
        }
        else
        {
            // No results voice
            await _candySound?.PlayVoiceLine("058"); // "Couldn't find that"
            
            StatusText.Text = "No files found";
        }
    }
    catch (Exception ex)
    {
        // Error voice
        await _candySound?.PlayVoiceLine("056"); // "Oops! Something went wrong..."
        
        MessageBox.Show($"Search error: {ex.Message}");
    }
}
```

---

## Example: Organize Downloads with Progress

```csharp
private async void OrganizeDownloads_Click(object sender, RoutedEventArgs e)
{
    try
    {
        // Play start voice
        await _candySound?.PlayVoiceLine("018"); // "Looking for something specific?"
        
        // Organize files
        var downloadsFolder = Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + @"\Downloads";
        int filesOrganized = await _candyFiles?.OrganizeFilesByCategoryAsync(downloadsFolder) ?? 0;
        
        // Success voice
        await _candySound?.PlayVoiceLine("042"); // "Perfect!"
        
        MessageBox.Show($"Organized {filesOrganized} files into categories!");
    }
    catch (Exception ex)
    {
        // Error voice
        await _candySound?.PlayVoiceLine("056"); // "Oops! Something went wrong..."
        
        MessageBox.Show($"Error: {ex.Message}");
    }
}
```

---

## Testing Your Integration

### 1. Test Voice on Startup
The app should play a greeting when it launches (already integrated in constructor)

### 2. Test Voice Toggle
- Right-click Candy-Bot avatar
- Toggle "Voice Mode" on/off
- Should show confirmation message

### 3. Test Sounds Toggle
- Right-click Candy-Bot avatar
- Toggle "Sounds" on/off
- Should show confirmation message

### 4. Test Personality Changes
- Right-click Candy-Bot avatar
- Select different personality
- Verify mode changes

### 5. Optional: Run Verification
Add to MainWindow constructor to test on startup:
```csharp
// In constructor, after other initialization
#if DEBUG
    VerifyCandyBot(); // Only in debug builds
#endif
```

---

## Troubleshooting

### Voice Not Playing?
1. Check if voice files exist in `Voices/` folder (001.mp3 - 100.mp3)
2. Verify VoiceMode is enabled: `_candySound?.SetVoiceMode(true);`
3. Check system volume and audio output

### File Search Not Working?
1. Approve folders first: `_candyFiles?.AddApprovedFolder(@"C:\YourFolder");`
2. Verify folder permissions
3. Check if files match search pattern

### Services Are Null?
Services initialize in constructor. Make sure they're initialized before use:
```csharp
if (_candySound != null)
{
    await _candySound.PlayGreeting();
}
```

---

## Next Steps

### Phase 3: Add Voice to More Operations
Add voice feedback to:
- User login/logout
- Venue creation/deletion
- Chat messages
- Radio station changes
- Error dialogs
- Success notifications

### Phase 4: Settings UI
Create a dedicated settings panel for Candy-Bot voice controls

### Phase 5: File Manager UI
Create a file browser window using CandyBotFileManager

---

**Happy Coding!** ???

The Candy-Bot services are now fully integrated and ready to enhance your DJ Booking System with voice feedback and file management capabilities!
