# ?? PHASE 2 - Adding 4 Claude Indicators to MainWindow

## ?? Objective
Add the 4 Claude connection indicators to the top of the MainWindow and all its tabs.

---

## ?? Implementation Steps

### Step 1: Update MainWindow.xaml
Add a new row at the top of the MainWindow Grid for the Claude indicators.

**Location**: Top of the content area, below the menu bar

**Code**:
```xaml
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>  <!-- Menu Bar -->
        <RowDefinition Height="Auto"/>  <!-- Claude Indicators (NEW) -->
        <RowDefinition Height="*"/>     <!-- Tab Content -->
    </Grid.RowDefinitions>
    
    <!-- Existing Menu Bar -->
    <Menu Grid.Row="0">
        <!-- ... existing menu items ... -->
    </Menu>
    
    <!-- NEW: Connection Status Indicators -->
    <StackPanel Grid.Row="1" 
                Orientation="Horizontal" 
                HorizontalAlignment="Center"
                Background="#0A0A0A"
                Margin="0,5,0,10">
        <controls:ClaudeIndicator x:Name="CosmosIndicator"
                                  ServiceName="Azure Cosmos DB"
                                  LabelText="Cosmos"
                                  IsConnected="True"
                                  Margin="8,0"/>
        <controls:ClaudeIndicator x:Name="LPMIndicator"
                                  ServiceName="Live Party Music"
                                  LabelText="LPM.fm"
                                  IsConnected="True"
                                  Margin="8,0"/>
        <controls:ClaudeIndicator x:Name="RadioBossIndicator"
                                  ServiceName="RadioBOSS Control"
                                  LabelText="Booking"
                                  IsConnected="True"
                                  Margin="8,0"/>
        <controls:ClaudeIndicator x:Name="StreamIndicator"
                                  ServiceName="RadioBOSS Stream"
                                  LabelText="Live Status"
                                  IsConnected="True"
                                  Margin="8,0"/>
    </StackPanel>
    
    <!-- Existing TabControl -->
    <TabControl Grid.Row="2">
        <!-- ... existing tabs ... -->
    </TabControl>
</Grid>
```

---

### Step 2: Update MainWindow.xaml.cs
Add connection monitoring logic.

**Add to constructor**:
```csharp
private DispatcherTimer? _connectionCheckTimer;

public MainWindow(CosmosDbService cosmosService, User loggedInUser, AppSettings appSettings)
{
    // ... existing initialization ...
    
    // Start periodic connection checks (every 30 seconds)
    _connectionCheckTimer = new DispatcherTimer 
    { 
        Interval = TimeSpan.FromSeconds(30) 
    };
    _connectionCheckTimer.Tick += async (s, e) => await CheckConnectionsAsync();
    _connectionCheckTimer.Start();
    
    // Do initial connection check
    _ = CheckConnectionsAsync();
}

private async Task CheckConnectionsAsync()
{
    try
    {
        var results = await ConnectionService.CheckAllConnectionsAsync(_cosmosService);
        
        Dispatcher.Invoke(() =>
        {
            CosmosIndicator.IsConnected = results.CosmosDbConnected;
            LPMIndicator.IsConnected = results.LivePartyMusicConnected;
            RadioBossIndicator.IsConnected = results.RadioBossControlConnected;
            StreamIndicator.IsConnected = results.RadioBossStreamActive;
        });
    }
    catch (Exception ex)
    {
        System.Diagnostics.Debug.WriteLine($"Error checking connections: {ex.Message}");
    }
}

protected override void OnClosed(EventArgs e)
{
    _connectionCheckTimer?.Stop();
    base.OnClosed(e);
}
```

---

### Step 3: Test MainWindow
1. Build and run application
2. Verify 4 Claude indicators appear at top
3. Verify they default to green
4. Verify they update every 30 seconds
5. Test connection loss scenarios

---

## ?? Expected Result

```
??????????????????????????????????????????????????????????
?  File  Edit  Admin  Help                               ?
??????????????????????????????????????????????????????????
?          (^_^)  (^_^)  (^_^)  (^_^)                   ?
?          Cosmos LPM.fm Booking Live Status             ?
??????????????????????????????????????????????????????????
?  [Bookings] [Venues] [Settings] [Radio] [Chat]        ?
?  ???????????????????????????????????????????????????? ?
?  ?                                                  ? ?
?  ?          Tab Content Here                       ? ?
?  ?                                                  ? ?
?  ???????????????????????????????????????????????????? ?
??????????????????????????????????????????????????????????
```

---

## ?? Files to Modify

1. **MainWindow.xaml** - Add Claude indicators row
2. **MainWindow.xaml.cs** - Add connection checking logic

---

## ?? Estimated Time

**30 minutes** - Simple addition, pattern already established

---

## ? Completion Criteria

- [ ] 4 Claude indicators visible at top of MainWindow
- [ ] Indicators default to green
- [ ] Connection checks run every 30 seconds
- [ ] Indicators update based on actual connection status
- [ ] No build errors
- [ ] Visual layout looks professional

---

**Status**: ? Ready to implement  
**Priority**: ?? HIGH (Phase 2, Step 1)  
**Dependencies**: Phase 1 ? Complete
