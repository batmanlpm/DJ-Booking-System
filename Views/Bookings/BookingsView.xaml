<UserControl x:Class="DJBookingSystem.Views.Bookings.BookingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:conv="clr-namespace:DJBookingSystem.Converters"
             Background="Black">
    
    <UserControl.Resources>
        <conv:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </UserControl.Resources>
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/> <!-- Header -->
                <RowDefinition Height="Auto"/> <!-- Filter Bar -->
                <RowDefinition Height="*"/>    <!-- DataGrid -->
                <RowDefinition Height="Auto"/> <!-- Action Buttons -->
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" 
                    Style="{StaticResource ContentPanelBorderStyle}"
                    Margin="0,0,0,20">
                <TextBlock Text="?? VIEW BOOKINGS"
                          Style="{StaticResource HeaderTextStyle}"
                          HorizontalAlignment="Center"/>
            </Border>

            <!-- Filter Bar -->
            <Border Grid.Row="1"
                    Style="{StaticResource SectionBorderStyle}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Filter by Venue:" 
                              Style="{StaticResource LabelTextStyle}"
                              VerticalAlignment="Center" 
                              Margin="0,0,10,0"/>
                    <ComboBox x:Name="VenueFilterComboBox"
                             Width="200"
                             SelectionChanged="VenueFilter_Changed"
                             Style="{StaticResource InputComboBoxStyle}"/>
                    <Button Content="Refresh"
                           Click="RefreshBookings_Click"
                           Style="{StaticResource SecondaryButtonStyle}"
                           Margin="20,0,0,0"
                           Padding="15,5"/>
                </StackPanel>
            </Border>

            <!-- Bookings DataGrid -->
            <Border Grid.Row="2"
                    Style="{StaticResource SectionBorderStyle}">
                <DataGrid x:Name="BookingsDataGrid"
                         AutoGenerateColumns="False"
                         CanUserAddRows="False"
                         SelectionMode="Single"
                         IsReadOnly="True"
                         Background="Black"
                         Foreground="#00FF00"
                         BorderBrush="#00FF00"
                         SelectionChanged="BookingsDataGrid_SelectionChanged">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="DJ Name" Binding="{Binding DJName}" Width="200"/>
                        <DataGridTextColumn Header="Streaming Link" Binding="{Binding StreamingLink}" Width="300"/>
                        <DataGridTextColumn Header="Venue" Binding="{Binding Venue}" Width="200"/>
                        <DataGridTextColumn Header="Booking Date" Binding="{Binding BookingDate, StringFormat=\{0:MM/dd/yyyy HH:mm\}}" Width="150"/>
                        <DataGridTextColumn Header="Created" Binding="{Binding CreatedAt, StringFormat=\{0:MM/dd/yyyy\}}" Width="120"/>
                        <DataGridTemplateColumn Header="Actions" Width="150">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Content="?? Copy Link"
                                           Click="CopyStreamingLink_Click"
                                           Tag="{Binding ActualStreamingLink}"
                                           Style="{StaticResource SecondaryButtonStyle}"
                                           Padding="8,4"
                                           Margin="2"
                                           Visibility="{Binding CanCopyStreamingLink, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>

            <!-- Action Buttons -->
            <Border Grid.Row="3"
                    Style="{StaticResource SectionBorderStyle}">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button Content="View Details"
                           Click="ViewDetails_Click"
                           Style="{StaticResource PrimaryButtonStyle}"
                           Margin="5"/>
                    <Button x:Name="EditBookingButton"
                           Content="Edit"
                           Click="EditBooking_Click"
                           Style="{StaticResource SecondaryButtonStyle}"
                           Margin="5"/>
                    <Button x:Name="DeleteBookingButton"
                           Content="Delete"
                           Click="DeleteBooking_Click"
                           Style="{StaticResource DangerButtonStyle}"
                           Margin="5"/>
                </StackPanel>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>
